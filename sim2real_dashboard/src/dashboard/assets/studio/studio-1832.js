"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1832],{81832:(Be,L,n)=>{n.r(L),n.d(L,{default:()=>Ee});var t=n(52322),A=n(8740),r=n(2784),k=n(63318),q=n(63655),D=n(28319),_=n(91374),ee=n(66788),W=n(9322),V=n(480),te=n(87778),ne=n(28165),E=n(68234),se=n(29800),w=n(80078),ie=n(68434),K=n(96242),U=n(3104),T=n(86232),ae=n(9346),oe=n(88687),re=n(29268),le=n(76479),R=n(93812),B=n(77075),ue=n(60536),ce=n(34425),X=n(48376),Y=n(47591),de=n(2784);const pe="/api/sim2real/config/list",ge=(0,X.Z)("div")(({theme:s})=>({position:"sticky",top:"-8px",padding:"4px 10px",color:s.palette.primary.main,fontWeight:"bold",backgroundColor:s.palette.mode==="light"?(0,Y.$n)(s.palette.primary.light,.85):(0,Y._j)(s.palette.primary.main,.8)})),fe=(0,X.Z)("ul")({padding:0}),he=(0,A.ZL)()(s=>({input:{".MuiInputBase-root.MuiInputBase-sizeSmall .MuiAutocomplete-input.MuiInputBase-inputSizeSmall":{paddingBottom:s.spacing(.425),paddingTop:s.spacing(.425)},".MuiInputBase-root.MuiInputBase-sizeSmall":{padding:s.spacing(.125),gap:s.spacing(.25)}},chip:{"&.MuiAutocomplete-tag":{margin:0}}})),me=de.memo(function(y){const{classes:x}=he(),o=(0,r.useCallback)(async()=>{const u=await(await fetch(pe)).json();let f=[];return f.push(...u.trainingFiles.map(c=>({name:c,type:"training"})),...u.sim2realFiles.map(c=>({name:c,type:"sim2real"}))),f},[]),[v,m]=(0,r.useState)([]),[p,g]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{g(!0),o().then(i=>{m(i),g(!1)}).catch(i=>{console.log(i),g(!1)})},[o]),(0,t.jsxs)(ue.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1,flexShrink:0,spacing:.25,children:[(0,t.jsx)(K.Z,{sx:{color:i=>i.palette.text.primary,zIndex:i=>i.zIndex.drawer+1,position:"absolute"},open:p,children:(0,t.jsx)(U.Z,{color:"inherit"})}),(0,t.jsx)(ce.Z,{disabled:y.disabled,onChange:(i,u)=>y.onChange(u?.name,u?.type),options:v,freeSolo:!0,fullWidth:!0,groupBy:i=>i.type,getOptionLabel:i=>i.name,ChipProps:{className:x.chip,variant:"filled",size:"small"},renderGroup:i=>(0,t.jsxs)("li",{children:[(0,t.jsx)(ge,{children:i.group.toUpperCase()}),(0,t.jsx)(fe,{children:i.children})]},i.key),renderInput:i=>(0,t.jsx)(E.Z,{...i,size:"small",className:x.input,placeholder:"Search a file"})})]})});var xe=n(49001),$=n(87037),z=n(76635),ve=n(16003);const Ie=(0,A.ZL)()(s=>({iconButton:{"&.MuiIconButton-edgeStart":{marginLeft:s.spacing(-.75),borderTopRightRadius:0,borderBottomRightRadius:0},"&.MuiIconButton-edgeEnd":{marginRight:s.spacing(-.75),borderTopLeftRadius:0,borderBottomLeftRadius:0}},textField:{".MuiInputBase-formControl.MuiInputBase-root":{paddingTop:0,paddingBottom:0},width:"165px","& .MuiInputBase-root":{fontFamily:B.R.MONOSPACE,fontSize:"0.86rem",lineHeight:1.5},".MuiInputBase-input":{textAlign:"center",fontFamily:B.R.MONOSPACE,cursor:"ew-resize","&::-webkit-outer-spin-button, &::-webkit-inner-spin-button":{appearance:"none",margin:0}},"@media (pointer: fine)":{".MuiIconButton-root":{visibility:"hidden"},"&:hover .MuiIconButton-root":{visibility:"visible"}}},textFieldReadonly:{".MuiInputBase-input":{cursor:"auto"}}}));function ye(s){const{classes:y,cx:x}=Ie(),{value:o,iconDown:v,iconUp:m,step:p=1,min:g,max:i,onChange:u,disabled:f,readOnly:c,precision:j=2}=s,I=(0,r.useRef)(null),N=(0,r.useRef)(0),P=(0,ve.Z)(o),F=(0,z.isFinite)(Number(s.placeholder))?Number(s.placeholder):void 0,S=(0,r.useCallback)(e=>{if(f===!0||c===!0)return;const d=e==null?void 0:(0,z.clamp)(e,g??Number.NEGATIVE_INFINITY,i??Number.POSITIVE_INFINITY);u(d!=null?Number(d.toFixed(j)):d)},[f,c,g,i,u,j]),O=(0,r.useCallback)(e=>{e.currentTarget.setPointerCapture(e.pointerId);const d=P.current??F??0;N.current=(0,z.isFinite)(d)?d:0},[P,F]),G=(0,r.useCallback)(e=>{e.currentTarget.releasePointerCapture(e.pointerId)},[]),M=(0,r.useCallback)(e=>{if(e.buttons===1){e.preventDefault(),e.currentTarget.blur();const d=e.shiftKey?10:1,l=Math.sign(e.movementX)*Math.pow(Math.abs(e.movementX),1.5)*.1*p*d;N.current+=l,S(N.current)}},[p,S]),a=I.current===document.activeElement?o:o?.toFixed(j);return(0,t.jsx)(E.Z,{...s,value:a??"",onChange:e=>S(e.target.value.length>0?Number(e.target.value):void 0),type:"number",className:x(y.textField,{[y.textFieldReadonly]:c}),inputProps:{ref:I,step:p,onPointerDown:O,onPointerUp:G,onPointerMove:M},InputProps:{readOnly:c,startAdornment:(0,t.jsx)($.Z,{className:y.iconButton,size:"small",edge:"start",tabIndex:-1,onClick:e=>S((o??F??0)-(e.shiftKey?p*10:p)),children:v??(0,t.jsx)(xe.Z,{fontSize:"small"})}),endAdornment:(0,t.jsx)($.Z,{className:y.iconButton,size:"small",edge:"end",tabIndex:-1,onClick:e=>S((o??F??0)+(e.shiftKey?p*10:p)),children:m??(0,t.jsx)(D.Z,{fontSize:"small"})})}})}var je=n(14075);const J="/api/sim2real/config/:type/:name",Ce="/api/sim2real/training/start/:name",Se="/api/sim2real/training/status",Te="/api/sim2real/training/stop",Fe="/api/sim2real/training/pause",be="/api/sim2real/training/resume",Ze=(0,ne.F4)`
0% {
  opacity: 1;
}
  50% {
  opacity: 0.1;
}
100% {
  opacity: 1;
}
`,Q=(0,A.ZL)()(s=>({inputWrapper:{width:"100%",lineHeight:"20px"},monospace:{fontFamily:B.R.MONOSPACE},fieldGrid:{display:"flex",alignItems:"right",flexDirection:"column",listStyle:"none",margin:s.spacing(.3,0),"& > .MuiTreeItem-content":{padding:0,"& > .MuiTreeItem-label":{padding:0}}},textField:{border:0,width:"165px","& .MuiInputBase-root":{fontFamily:B.R.MONOSPACE,fontSize:"0.86rem",lineHeight:1.5,"& .MuiInputBase-input":{textAlign:"center",borderColor:"transparent",width:"100%"}}},pulse:{animation:`${Ze} 1.2s infinite`},startAdornment:{display:"flex"},fieldLabel:{paddingLeft:s.spacing(.2),position:"relative",fontFeatureSettings:"'cv08','cv10','tnum'",fontFamily:"Inter",fontWeight:400,fontSize:"0.86rem",lineHeight:1.5,cursor:"pointer"},fieldWrapper:{minWidth:s.spacing(14),marginRight:s.spacing(.5),justifySelf:"flex-end"}}));function Ne({onChange:s,value:y,type:x,inputId:o}){const{classes:v}=Q(),[m,p]=(0,r.useState)(y),g=(0,r.useCallback)(c=>{p(c.target.value)},[p]),i=(0,r.useCallback)(c=>{if(!c){p("");return}isFinite(c)&&(p(c),s(c,x))},[p]),u=(0,r.useCallback)(c=>{p(c.target.value==="true")},[p]),f=(0,r.useCallback)(()=>{s(m,x)},[m,s,x]);switch(x){case"number":return(0,t.jsx)(ye,{size:"small",variant:"filled",value:m,readOnly:!1,className:v.textField,id:o,fullWidth:!0,onChange:i});case"string":return(0,t.jsx)(E.Z,{className:v.textField,fullWidth:!0,size:"small",variant:"filled",id:o,value:m,onChange:g,onBlur:f});case"boolean":return(0,t.jsxs)(se.Z,{className:v.textField,fullWidth:!0,id:o,size:"small",variant:"filled",value:m,onChange:u,onBlur:f,children:[(0,t.jsx)(w.Z,{sx:{textAlign:"center"},value:"false",children:"false"},0),(0,t.jsx)(w.Z,{sx:{textAlign:"center"},value:"true",children:"true"},1)]});default:return(0,t.jsx)(E.Z,{className:v.textField,fullWidth:!0,size:"small",variant:"filled",id:o,value:m,onChange:g,onBlur:f})}}function H(){const{classes:s}=Q(),[y,x]=(0,r.useState)(!1),[o,v]=(0,r.useState)(null),[m,p]=(0,r.useState)(null);let g=[];const[i,u]=(0,r.useState)({message:"",severity:"success",open:!1,autoHideDuration:3e3}),[f,c]=(0,r.useState)(null),[j,I]=(0,r.useState)(),N=(0,r.useCallback)((a,e)=>{if(!a){v(null);return}v({name:a,type:e})},[v]);(0,r.useEffect)(()=>{if(o){const{name:a,type:e}=o;if(!a||!e)return;x(!0),(async(l,h)=>{const C=J.replace(":name",l).replace(":type",h);return await(await fetch(C)).json()})(a,e).then(l=>{p(l),g=[]}).finally(()=>{x(!1)})}},[o]);const P=(0,r.useCallback)(()=>{if(!o)return;const{name:a,type:e}=o;if(!a||!e)return;x(!0),(async(l,h)=>{const C=J.replace(":name",l).replace(":type",h);return await(await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).json()})(a,e).then(l=>{p(l),g=[],u({message:"File saved succesfully!",severity:"success",open:!0,autoHideDuration:3e3})}).finally(()=>{x(!1)})},[o,m,x,p,g,u]),F=(0,r.useCallback)(()=>{if(!o)return;const{name:a,type:e}=o;if(!a||!e||e!=="training")return;(async h=>{const C=Ce.replace(":name",h);return await fetch(C,{method:"GET",headers:{"Content-Type":"application/json"}}).then(Z=>Z.json())})(a).then(h=>{console.log(h),I("running")});const l=async()=>await fetch(Se,{method:"GET",headers:{"Content-Type":"application/json"}}).then(b=>b.json());c(setInterval(()=>{l().then(h=>{h.status==="finished"?(clearInterval(f),c(null),u({message:"Training finished succesfully!",severity:"success",open:!0,autoHideDuration:null}),I("finished")):h.status==="finished_with_error"&&(clearInterval(f),c(null),I("finished_with_error"),u({message:"Training finished with error! Please check ros logs for more information.",severity:"error",open:!0,autoHideDuration:null}))})},1e3))},[o]);(0,r.useEffect)(()=>()=>{f&&clearInterval(f)},[f]);const S=(0,r.useCallback)(()=>{(async()=>await fetch(Te,{method:"GET",headers:{"Content-Type":"application/json"}}).then(l=>l.json()))().then(e=>{e.status==="stopped"&&(clearInterval(f),c(null),u({message:"Training stopped!",severity:"success",open:!0,autoHideDuration:null}),I("stopped"))}).catch(e=>{u({message:"Error stopping training!",severity:"error",open:!0,autoHideDuration:null}),console.log(e)})},[f,c,u,I]),O=(0,r.useCallback)(()=>{(async()=>await fetch(Fe,{method:"GET",headers:{"Content-Type":"application/json"}}).then(l=>l.json()))().then(e=>{e.status==="paused"&&(u({message:"Training paused!",severity:"success",open:!0,autoHideDuration:2e3}),I("paused"))}).catch(e=>{u({message:"Error pausing training!",severity:"error",open:!0,autoHideDuration:2e3}),console.log(e)})},[f,c,I]),G=(0,r.useCallback)(()=>{(async()=>await fetch(be,{method:"GET",headers:{"Content-Type":"application/json"}}).then(l=>l.json()))().then(e=>{e.status==="running"&&(I("running"),u({message:"Training resumed!",severity:"success",open:!0,autoHideDuration:2e3}))}).catch(e=>{u({message:"Error resuming training!",severity:"error",open:!0,autoHideDuration:2e3}),console.log(e)})},[j,I]),M=a=>typeof a!="object"||a===null?null:Object.keys(a).map(e=>{let d="";if(g.indexOf(e)===-1)g.push(e),d=e;else{const l=new RegExp(e+"-[0-9]+"),h=g.filter(C=>l.test(C));if(h.length>0){const C=h[h.length-1],b=Number(C?.split("-")[1]),Z=e+"-"+(b+1);g.push(Z),d=Z}else g.push(e+"-1"),d=e+"-1"}return typeof a[e]=="object"?(0,t.jsx)(te.Z,{nodeId:d,label:e,className:s.fieldGrid,children:M(a[e])},d):(0,t.jsx)("li",{className:s.fieldGrid,children:(0,t.jsxs)(R.Z,{paddingLeft:.2,fullHeight:!0,direction:"row",alignItems:"center",flex:1,justifyContent:"space-between",children:[(0,t.jsx)(ie.Z,{className:s.fieldLabel,title:e,variant:"subtitle2",onClick:()=>{const l=document.getElementById(e+d);l&&l.focus()},children:e}),(0,t.jsx)("div",{className:s.fieldWrapper,children:(0,t.jsx)(Ne,{onChange:(l,h)=>{h==="number"?a[e]=Number(l):h==="boolean"?a[e]=Boolean(l):a[e]=l,p({...m})},inputId:e+d,value:a[e],type:typeof a[e]})})]})},d)});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(R.Z,{flex:"auto",overflow:"hidden",position:"relative",children:[(0,t.jsx)(le.Z,{children:(0,t.jsx)("div",{className:s.inputWrapper,children:(0,t.jsx)(me,{onChange:N,disabled:j==="running"||j==="paused"})})}),!o&&(0,t.jsx)(re.Z,{children:"No file selected"}),(0,t.jsx)(K.Z,{sx:{color:a=>a.palette.text.primary,zIndex:a=>a.zIndex.drawer+1,position:"absolute"},open:y,children:(0,t.jsx)(U.Z,{color:"inherit"})}),m&&o&&(0,t.jsx)(k.Z,{"aria-label":"rich object",defaultCollapseIcon:(0,t.jsx)(q.Z,{}),defaultExpanded:["root"],defaultExpandIcon:(0,t.jsx)(D.Z,{}),sx:{flexGrow:1,overflow:"auto"},children:M(m)},o.name)]}),o&&(0,t.jsxs)(R.Z,{direction:"row",alignItems:"center",justifyContent:"flex-end",flexShrink:0,gap:.5,padding:1,style:{borderTop:"1px solid rgba(0, 0, 0, 0.12)"},children:[(0,t.jsx)(T.Z,{variant:"outlined",startIcon:(0,t.jsx)(_.Z,{}),onClick:P,children:"Save"}),o.type==="training"&&j!="running"&&j!="paused"&&(0,t.jsx)(T.Z,{variant:"outlined",startIcon:(0,t.jsx)(ee.Z,{}),onClick:F,children:"Execute"}),o.type==="training"&&j=="running"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.Z,{variant:"outlined",startIcon:(0,t.jsx)(V.Z,{}),color:"warning",onClick:O,children:"Pause"}),(0,t.jsx)(T.Z,{variant:"outlined",startIcon:(0,t.jsx)(W.Z,{}),color:"error",onClick:S,children:"Stop"})]}),o.type==="training"&&j=="paused"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.Z,{variant:"outlined",startIcon:(0,t.jsx)(V.Z,{className:s.pulse}),color:"warning",onClick:G,children:"Resume"}),(0,t.jsx)(T.Z,{variant:"outlined",startIcon:(0,t.jsx)(W.Z,{}),color:"error",onClick:S,children:"Stop"})]})]}),(0,t.jsx)(ae.Z,{open:i.open,onClose:()=>u({...i,open:!1}),autoHideDuration:i.autoHideDuration,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{position:"absolute",width:"80%"},children:(0,t.jsx)(oe.Z,{onClose:()=>u({...i,open:!1}),severity:i.severity,sx:{width:"100%"},children:i.message})})]})}H.panelType="ConfigEditor",H.defaultConfig={topicPath:""};const Ee=(0,je.Z)(H)}}]);

//# sourceMappingURL=studio-1832.js.map