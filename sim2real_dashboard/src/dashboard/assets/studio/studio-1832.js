"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1832],{81832:(ye,z,n)=>{n.r(z),n.d(z,{default:()=>Ce});var e=n(52322),M=n(8740),r=n(2784),U=n(63318),X=n(63655),O=n(28319),Y=n(91374),J=n(66788),$=n(9322),Q=n(87778),b=n(68234),k=n(29800),L=n(80078),q=n(68434),H=n(96242),G=n(3104),E=n(86232),_=n(9346),ee=n(88687),te=n(29268),ne=n(76479),P=n(93812),Z=n(77075),se=n(60536),ie=n(34425),W=n(48376),D=n(47591),ae=n(2784);const oe="/api/sim2real/config/list",le=(0,W.Z)("div")(({theme:s})=>({position:"sticky",top:"-8px",padding:"4px 10px",color:s.palette.primary.main,fontWeight:"bold",backgroundColor:s.palette.mode==="light"?(0,D.$n)(s.palette.primary.light,.85):(0,D._j)(s.palette.primary.main,.8)})),re=(0,W.Z)("ul")({padding:0}),ue=(0,M.ZL)()(s=>({input:{".MuiInputBase-root.MuiInputBase-sizeSmall .MuiAutocomplete-input.MuiInputBase-inputSizeSmall":{paddingBottom:s.spacing(.425),paddingTop:s.spacing(.425)},".MuiInputBase-root.MuiInputBase-sizeSmall":{padding:s.spacing(.125),gap:s.spacing(.25)}},chip:{"&.MuiAutocomplete-tag":{margin:0}}})),ce=ae.memo(function(y){const{classes:x}=ue(),l=(0,r.useCallback)(async()=>{const p=await(await fetch(oe)).json();let g=[];return g.push(...p.trainingFiles.map(u=>({name:u,type:"training"})),...p.sim2realFiles.map(u=>({name:u,type:"sim2real"}))),g},[]),[C,m]=(0,r.useState)([]),[c,h]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{h(!0),l().then(o=>{m(o),h(!1)}).catch(o=>{console.log(o),h(!1)})},[l]),(0,e.jsxs)(se.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1,flexShrink:0,spacing:.25,children:[(0,e.jsx)(H.Z,{sx:{color:o=>o.palette.text.primary,zIndex:o=>o.zIndex.drawer+1,position:"absolute"},open:c,children:(0,e.jsx)(G.Z,{color:"inherit"})}),(0,e.jsx)(ie.Z,{onChange:(o,p)=>y.onChange(p?.name,p?.type),options:C,freeSolo:!0,fullWidth:!0,groupBy:o=>o.type,getOptionLabel:o=>o.name,ChipProps:{className:x.chip,variant:"filled",size:"small"},renderGroup:o=>(0,e.jsxs)("li",{children:[(0,e.jsx)(le,{children:o.group.toUpperCase()}),(0,e.jsx)(re,{children:o.children})]},o.key),renderInput:o=>(0,e.jsx)(b.Z,{...o,size:"small",className:x.input,placeholder:"Search a file"})})]})});var de=n(49001),V=n(87037),A=n(76635),pe=n(16003);const fe=(0,M.ZL)()(s=>({iconButton:{"&.MuiIconButton-edgeStart":{marginLeft:s.spacing(-.75),borderTopRightRadius:0,borderBottomRightRadius:0},"&.MuiIconButton-edgeEnd":{marginRight:s.spacing(-.75),borderTopLeftRadius:0,borderBottomLeftRadius:0}},textField:{".MuiInputBase-formControl.MuiInputBase-root":{paddingTop:0,paddingBottom:0},width:"165px","& .MuiInputBase-root":{fontFamily:Z.R.MONOSPACE,fontSize:"0.86rem",lineHeight:1.5},".MuiInputBase-input":{textAlign:"center",fontFamily:Z.R.MONOSPACE,cursor:"ew-resize","&::-webkit-outer-spin-button, &::-webkit-inner-spin-button":{appearance:"none",margin:0}},"@media (pointer: fine)":{".MuiIconButton-root":{visibility:"hidden"},"&:hover .MuiIconButton-root":{visibility:"visible"}}},textFieldReadonly:{".MuiInputBase-input":{cursor:"auto"}}}));function ge(s){const{classes:y,cx:x}=fe(),{value:l,iconDown:C,iconUp:m,step:c=1,min:h,max:o,onChange:p,disabled:g,readOnly:u,precision:F=2}=s,N=(0,r.useRef)(null),T=(0,r.useRef)(0),B=(0,pe.Z)(l),S=(0,A.isFinite)(Number(s.placeholder))?Number(s.placeholder):void 0,i=(0,r.useCallback)(a=>{if(g===!0||u===!0)return;const v=a==null?void 0:(0,A.clamp)(a,h??Number.NEGATIVE_INFINITY,o??Number.POSITIVE_INFINITY);p(v!=null?Number(v.toFixed(F)):v)},[g,u,h,o,p,F]),t=(0,r.useCallback)(a=>{a.currentTarget.setPointerCapture(a.pointerId);const v=B.current??S??0;T.current=(0,A.isFinite)(v)?v:0},[B,S]),I=(0,r.useCallback)(a=>{a.currentTarget.releasePointerCapture(a.pointerId)},[]),d=(0,r.useCallback)(a=>{if(a.buttons===1){a.preventDefault(),a.currentTarget.blur();const v=a.shiftKey?10:1,j=Math.sign(a.movementX)*Math.pow(Math.abs(a.movementX),1.5)*.1*c*v;T.current+=j,i(T.current)}},[c,i]),f=N.current===document.activeElement?l:l?.toFixed(F);return(0,e.jsx)(b.Z,{...s,value:f??"",onChange:a=>i(a.target.value.length>0?Number(a.target.value):void 0),type:"number",className:x(y.textField,{[y.textFieldReadonly]:u}),inputProps:{ref:N,step:c,onPointerDown:t,onPointerUp:I,onPointerMove:d},InputProps:{readOnly:u,startAdornment:(0,e.jsx)(V.Z,{className:y.iconButton,size:"small",edge:"start",tabIndex:-1,onClick:a=>i((l??S??0)-(a.shiftKey?c*10:c)),children:C??(0,e.jsx)(de.Z,{fontSize:"small"})}),endAdornment:(0,e.jsx)(V.Z,{className:y.iconButton,size:"small",edge:"end",tabIndex:-1,onClick:a=>i((l??S??0)+(a.shiftKey?c*10:c)),children:m??(0,e.jsx)(O.Z,{fontSize:"small"})})}})}var he=n(14075);const K="/api/sim2real/config/:type/:name",me="/api/sim2real/training/start/:name",xe="/api/sim2real/training/status",ve="/api/sim2real/training/stop",w=(0,M.ZL)()(s=>({inputWrapper:{width:"100%",lineHeight:"20px"},monospace:{fontFamily:Z.R.MONOSPACE},fieldGrid:{display:"flex",alignItems:"right",flexDirection:"column",listStyle:"none",margin:s.spacing(.3,0),"& > .MuiTreeItem-content":{padding:0,"& > .MuiTreeItem-label":{padding:0}}},textField:{border:0,width:"165px","& .MuiInputBase-root":{fontFamily:Z.R.MONOSPACE,fontSize:"0.86rem",lineHeight:1.5,"& .MuiInputBase-input":{textAlign:"center",borderColor:"transparent",width:"100%"}}},startAdornment:{display:"flex"},fieldLabel:{paddingLeft:s.spacing(.2),position:"relative",fontFeatureSettings:"'cv08','cv10','tnum'",fontFamily:"Inter",fontWeight:400,fontSize:"0.86rem",lineHeight:1.5,cursor:"pointer"},fieldWrapper:{minWidth:s.spacing(14),marginRight:s.spacing(.5),justifySelf:"flex-end"}}));function Ie({onChange:s,value:y,type:x,inputId:l}){const{classes:C}=w(),[m,c]=(0,r.useState)(y),h=(0,r.useCallback)(u=>{c(u.target.value)},[c]),o=(0,r.useCallback)(u=>{if(!u){c("");return}isFinite(u)&&(c(u),s(u,x))},[c]),p=(0,r.useCallback)(u=>{c(u.target.value==="true")},[c]),g=(0,r.useCallback)(()=>{s(m,x)},[m,s,x]);switch(x){case"number":return(0,e.jsx)(ge,{size:"small",variant:"filled",value:m,readOnly:!1,className:C.textField,id:l,fullWidth:!0,onChange:o});case"string":return(0,e.jsx)(b.Z,{className:C.textField,fullWidth:!0,size:"small",variant:"filled",id:l,value:m,onChange:h,onBlur:g});case"boolean":return(0,e.jsxs)(k.Z,{className:C.textField,fullWidth:!0,id:l,size:"small",variant:"filled",value:m,onChange:p,onBlur:g,children:[(0,e.jsx)(L.Z,{sx:{textAlign:"center"},value:"false",children:"false"},0),(0,e.jsx)(L.Z,{sx:{textAlign:"center"},value:"true",children:"true"},1)]});default:return(0,e.jsx)(b.Z,{className:C.textField,fullWidth:!0,size:"small",variant:"filled",id:l,value:m,onChange:h,onBlur:g})}}function R(){const{classes:s}=w(),[y,x]=(0,r.useState)(!1),[l,C]=(0,r.useState)(null),[m,c]=(0,r.useState)(null);let h=[];const[o,p]=(0,r.useState)({message:"",severity:"success",open:!1,autoHideDuration:3e3}),[g,u]=(0,r.useState)(null),F=(0,r.useCallback)((i,t)=>{if(!i){C(null);return}C({name:i,type:t})},[C]);(0,r.useEffect)(()=>{if(l){const{name:i,type:t}=l;if(!i||!t)return;x(!0),(async(d,f)=>{const a=K.replace(":name",d).replace(":type",f);return await(await fetch(a)).json()})(i,t).then(d=>{c(d),h=[]}).finally(()=>{x(!1)})}},[l]);const N=(0,r.useCallback)(()=>{if(!l)return;const{name:i,type:t}=l;if(!i||!t)return;x(!0),(async(d,f)=>{const a=K.replace(":name",d).replace(":type",f);return await(await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).json()})(i,t).then(d=>{c(d),h=[],p({message:"File saved succesfully!",severity:"success",open:!0,autoHideDuration:3e3})}).finally(()=>{x(!1)})},[l,m,x,c,h,p]),T=(0,r.useCallback)(()=>{if(!l)return;const{name:i,type:t}=l;if(!i||!t||t!=="training")return;(async f=>{const a=me.replace(":name",f);return await fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}}).then(j=>j.json())})(i).then(f=>{console.log(f)});const d=async()=>await fetch(xe,{method:"GET",headers:{"Content-Type":"application/json"}}).then(v=>v.json());u(setInterval(()=>{d().then(f=>{f.status==="finished"?(clearInterval(g),u(null),p({message:"Training finished succesfully!",severity:"success",open:!0,autoHideDuration:null})):f.status==="finished_with_error"&&(clearInterval(g),u(null),p({message:"Training finished with error! Please check ros logs for more information.",severity:"error",open:!0,autoHideDuration:null}))})},1e3))},[l]);(0,r.useEffect)(()=>()=>{g&&clearInterval(g)},[g]);const B=(0,r.useCallback)(()=>{(async()=>await fetch(ve,{method:"GET",headers:{"Content-Type":"application/json"}}).then(d=>d.json()))().then(t=>{t.status==="stopped"&&(clearInterval(g),u(null),p({message:"Training stopped!",severity:"success",open:!0,autoHideDuration:null}))}).catch(t=>{p({message:"Error stopping training!",severity:"error",open:!0,autoHideDuration:null}),console.log(t)})},[g,u,p]),S=i=>typeof i!="object"||i===null?null:Object.keys(i).map(t=>{let I="";if(h.indexOf(t)===-1)h.push(t),I=t;else{const d=new RegExp(t+"-[0-9]+"),f=h.filter(a=>d.test(a));if(f.length>0){const a=f[f.length-1],v=Number(a?.split("-")[1]),j=t+"-"+(v+1);h.push(j),I=j}else h.push(t+"-1"),I=t+"-1"}return typeof i[t]=="object"?(0,e.jsx)(Q.Z,{nodeId:I,label:t,className:s.fieldGrid,children:S(i[t])},I):(0,e.jsx)("li",{className:s.fieldGrid,children:(0,e.jsxs)(P.Z,{paddingLeft:.2,fullHeight:!0,direction:"row",alignItems:"center",flex:1,justifyContent:"space-between",children:[(0,e.jsx)(q.Z,{className:s.fieldLabel,title:t,variant:"subtitle2",onClick:()=>{const d=document.getElementById(t+I);d&&d.focus()},children:t}),(0,e.jsx)("div",{className:s.fieldWrapper,children:(0,e.jsx)(Ie,{onChange:(d,f)=>{f==="number"?i[t]=Number(d):f==="boolean"?i[t]=Boolean(d):i[t]=d,c({...m})},inputId:t+I,value:i[t],type:typeof i[t]})})]})},I)});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(P.Z,{flex:"auto",overflow:"hidden",position:"relative",children:[(0,e.jsx)(ne.Z,{children:(0,e.jsx)("div",{className:s.inputWrapper,children:(0,e.jsx)(ce,{onChange:F})})}),!l&&(0,e.jsx)(te.Z,{children:"No file selected"}),(0,e.jsx)(H.Z,{sx:{color:i=>i.palette.text.primary,zIndex:i=>i.zIndex.drawer+1,position:"absolute"},open:y,children:(0,e.jsx)(G.Z,{color:"inherit"})}),m&&l&&(0,e.jsx)(U.Z,{"aria-label":"rich object",defaultCollapseIcon:(0,e.jsx)(X.Z,{}),defaultExpanded:["root"],defaultExpandIcon:(0,e.jsx)(O.Z,{}),sx:{flexGrow:1,overflow:"auto"},children:S(m)},l.name)]}),l&&(0,e.jsxs)(P.Z,{direction:"row",alignItems:"center",justifyContent:"flex-end",flexShrink:0,gap:.5,padding:1,style:{borderTop:"1px solid rgba(0, 0, 0, 0.12)"},children:[(0,e.jsx)(E.Z,{variant:"outlined",startIcon:(0,e.jsx)(Y.Z,{}),onClick:N,children:"Save"}),l.type==="training"&&g===null&&(0,e.jsx)(E.Z,{variant:"outlined",startIcon:(0,e.jsx)(J.Z,{}),onClick:T,children:"Execute"}),l.type==="training"&&g!==null&&(0,e.jsx)(E.Z,{variant:"outlined",startIcon:(0,e.jsx)($.Z,{}),color:"error",onClick:B,children:"Stop (Running...)"})]}),(0,e.jsx)(_.Z,{open:o.open,onClose:()=>p({...o,open:!1}),autoHideDuration:o.autoHideDuration,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{position:"absolute",width:"80%"},children:(0,e.jsx)(ee.Z,{onClose:()=>p({...o,open:!1}),severity:o.severity,sx:{width:"100%"},children:o.message})})]})}R.panelType="ConfigEditor",R.defaultConfig={topicPath:""};const Ce=(0,he.Z)(R)}}]);

//# sourceMappingURL=studio-1832.js.map