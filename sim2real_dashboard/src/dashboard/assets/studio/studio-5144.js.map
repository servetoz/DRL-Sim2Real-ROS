{"version":3,"file":"studio-5144.js","mappings":"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","sources":["webpack:///../../packages/studio-base/src/components/CaptureErrorBoundary.tsx","webpack:///../../packages/studio-base/src/panels/Teleop/DirectionalPad.tsx","webpack:///../../packages/studio-base/src/panels/Teleop/TeleopPanel.tsx","webpack:///../../packages/studio-base/src/panels/Teleop/index.tsx"],"sourcesContent":["// This Source Code Form is subject to the terms of the Mozilla Public\n// License, v2.0. If a copy of the MPL was not distributed with this\n// file, You can obtain one at http://mozilla.org/MPL/2.0/\nimport { Component, PropsWithChildren, ReactNode } from \"react\";\n\ntype Props = {\n  onError: (err: Error) => void;\n};\n\ntype State = {\n  hadError: boolean;\n};\n\n/** An error boundary that calls an onError function when it captures an error */\nexport class CaptureErrorBoundary extends Component<PropsWithChildren<Props>, State> {\n  public override state: State = {\n    hadError: false,\n  };\n\n  public override componentDidCatch(error: Error): void {\n    this.setState({ hadError: true });\n    this.props.onError(error);\n  }\n\n  public override render(): ReactNode {\n    // Avoid rendering children since the children are what caused the error\n    if (this.state.hadError) {\n      return <></>;\n    }\n\n    return this.props.children;\n  }\n}\n","// This Source Code Form is subject to the terms of the Mozilla Public\n// License, v2.0. If a copy of the MPL was not distributed with this\n// file, You can obtain one at http://mozilla.org/MPL/2.0/\n\nimport { alpha } from \"@mui/material\";\nimport { useCallback, useState } from \"react\";\nimport { makeStyles } from \"tss-react/mui\";\n\nimport Stack from \"@foxglove/studio-base/components/Stack\";\n\nconst useStyles = makeStyles<void, \"buttonIcon\">()((theme, _params, classes) => ({\n  svg: {\n    label: \"DirectionalPad-svg\",\n    maxHeight: \"100%\",\n    maxWidth: \"100%\",\n  },\n  button: {\n    label: \"DirectionalPad-button\",\n    cursor: \"pointer\",\n    fill: theme.palette.action.hover,\n    stroke: theme.palette.divider,\n    strokeWidth: 0.5,\n\n    \"&:hover\": {\n      fill: alpha(\n        theme.palette.primary.main,\n        theme.palette.action.selectedOpacity + theme.palette.action.hoverOpacity,\n      ),\n      stroke: theme.palette.primary.main,\n\n      [`& + .${classes.buttonIcon}`]: {\n        fill: theme.palette.primary.main,\n      },\n    },\n    \"&.active\": {\n      fill: `${theme.palette.primary.main} !important`,\n      stroke: `${theme.palette.primary.dark} !important`,\n\n      \"&:hover\": {\n        [`& + .${classes.buttonIcon}`]: {\n          fill: theme.palette.common.white,\n        },\n      },\n    },\n    \"&.disabled\": {\n      cursor: \"auto\",\n      strokeWidth: 0,\n      fill: theme.palette.action.disabledBackground,\n\n      \"&:hover\": {\n        fill: theme.palette.action.disabledBackground,\n\n        [`& + .${classes.buttonIcon}`]: {\n          fill: theme.palette.background.default,\n        },\n      },\n    },\n  },\n  buttonIcon: {\n    pointerEvents: \"none\",\n    label: \"DirectionalPad-buttonIcon\",\n    fill: theme.palette.text.primary,\n\n    \"&.disabled\": {\n      fill: theme.palette.background.default,\n    },\n  },\n}));\n\nexport enum DirectionalPadAction {\n  UP,\n  DOWN,\n  LEFT,\n  RIGHT,\n}\n\ntype DirectionalPadProps = {\n  disabled?: boolean;\n  onAction?: (action?: DirectionalPadAction) => void;\n};\n\nfunction DirectionalPad(props: DirectionalPadProps): JSX.Element {\n  const { onAction, disabled = false } = props;\n\n  const [currentAction, setCurrentAction] = useState<DirectionalPadAction | undefined>();\n\n  const { classes, cx } = useStyles();\n\n  const handleMouseDown = useCallback(\n    (action: DirectionalPadAction) => {\n      setCurrentAction(action);\n      onAction?.(action);\n    },\n    [onAction],\n  );\n\n  const handleMouseUp = useCallback(() => {\n    if (currentAction == undefined) {\n      return;\n    }\n    setCurrentAction(undefined);\n    onAction?.();\n  }, [onAction, currentAction]);\n\n  const makeMouseHandlers = (action: DirectionalPadAction) =>\n    disabled\n      ? undefined\n      : {\n          onMouseDown: () => handleMouseDown(action),\n          onMouseUp: () => handleMouseUp(),\n          onMouseLeave: () => handleMouseUp(),\n        };\n\n  return (\n    <Stack\n      justifyContent=\"center\"\n      alignItems=\"center\"\n      fullWidth\n      fullHeight\n      style={{ userSelect: \"none\" }}\n    >\n      <svg className={classes.svg} viewBox=\"0 0 256 256\">\n        <g opacity={1}>\n          {/* UP button */}\n          <g {...makeMouseHandlers(DirectionalPadAction.UP)} role=\"button\">\n            <path\n              className={cx(classes.button, {\n                active: currentAction === DirectionalPadAction.UP,\n                disabled,\n              })}\n              d=\"M162.707,78.945c-20.74,-14.771 -48.795,-14.771 -69.535,-0l-42.723,-42.723c44.594,-37.791 110.372,-37.794 154.981,-0l-42.723,42.723Z\"\n            />\n            <path\n              className={cx(classes.buttonIcon, { disabled })}\n              d=\"M128,30.364l20,20l-40,-0l20,-20Z\"\n            />\n          </g>\n\n          {/* DOWN button */}\n          <g {...makeMouseHandlers(DirectionalPadAction.DOWN)} role=\"button\">\n            <path\n              className={cx(classes.button, {\n                active: currentAction === DirectionalPadAction.DOWN,\n                disabled,\n              })}\n              d=\"M93.172,176.764c20.74,14.771 48.795,14.771 69.535,0l42.723,42.723c-44.594,37.791 -110.372,37.794 -154.981,0l42.723,-42.723Z\"\n            />\n            <path\n              className={cx(classes.buttonIcon, { disabled })}\n              d=\"M128,225.345l-20,-20l40,0l-20,20Z\"\n            />\n          </g>\n        </g>\n\n        <g opacity={1}>\n          {/* LEFT button */}\n          <g {...makeMouseHandlers(DirectionalPadAction.LEFT)} role=\"button\">\n            <path\n              className={cx(classes.button, {\n                active: currentAction === DirectionalPadAction.LEFT,\n                disabled,\n              })}\n              d=\"M36.307,205.345c-37.793,-44.609 -37.791,-110.387 -0,-154.981l42.723,42.723c-14.771,20.74 -14.771,48.795 -0,69.535l-42.723,42.723Z\"\n            />\n            <path\n              className={cx(classes.buttonIcon, { disabled })}\n              d=\"M30.449,127.854l20,-20l0,40l-20,-20Z\"\n            />\n          </g>\n\n          {/* RIGHT button */}\n          <g {...makeMouseHandlers(DirectionalPadAction.RIGHT)} role=\"button\">\n            <path\n              className={cx(classes.button, {\n                active: currentAction === DirectionalPadAction.RIGHT,\n                disabled,\n              })}\n              d=\"M219.572,50.364c37.794,44.609 37.791,110.387 0.001,154.981l-42.724,-42.723c14.771,-20.74 14.771,-48.795 0,-69.535l42.723,-42.723Z\"\n            />\n            <path\n              className={cx(classes.buttonIcon, { disabled })}\n              d=\"M225.43,127.854l-20,20l0,-40l20,20Z\"\n            />\n          </g>\n        </g>\n      </svg>\n    </Stack>\n  );\n}\n\nexport default DirectionalPad;\n","// This Source Code Form is subject to the terms of the Mozilla Public\n// License, v2.0. If a copy of the MPL was not distributed with this\n// file, You can obtain one at http://mozilla.org/MPL/2.0/\n\nimport { set } from \"lodash\";\nimport { useCallback, useEffect, useLayoutEffect, useState } from \"react\";\nimport { DeepPartial } from \"ts-essentials\";\n\nimport { ros1 } from \"@foxglove/rosmsg-msgs-common\";\nimport {\n  PanelExtensionContext,\n  SettingsTreeAction,\n  SettingsTreeNode,\n  SettingsTreeNodes,\n  Topic,\n} from \"@foxglove/studio\";\nimport EmptyState from \"@foxglove/studio-base/components/EmptyState\";\nimport Stack from \"@foxglove/studio-base/components/Stack\";\nimport ThemeProvider from \"@foxglove/studio-base/theme/ThemeProvider\";\n\nimport DirectionalPad, { DirectionalPadAction } from \"./DirectionalPad\";\n\ntype TeleopPanelProps = {\n  context: PanelExtensionContext;\n};\n\nconst geometryMsgOptions = [\n  { label: \"linear-x\", value: \"linear-x\" },\n  { label: \"linear-y\", value: \"linear-y\" },\n  { label: \"linear-z\", value: \"linear-z\" },\n  { label: \"angular-x\", value: \"angular-x\" },\n  { label: \"angular-y\", value: \"angular-y\" },\n  { label: \"angular-z\", value: \"angular-z\" },\n];\n\ntype Config = {\n  topic: undefined | string;\n  publishRate: number;\n  upButton: { field: string; value: number };\n  downButton: { field: string; value: number };\n  leftButton: { field: string; value: number };\n  rightButton: { field: string; value: number };\n};\n\nfunction buildSettingsTree(config: Config, topics: readonly Topic[]): SettingsTreeNodes {\n  const general: SettingsTreeNode = {\n    label: \"General\",\n    fields: {\n      publishRate: { label: \"Publish rate\", input: \"number\", value: config.publishRate },\n      topic: {\n        label: \"Topic\",\n        input: \"autocomplete\",\n        value: config.topic,\n        items: topics.map((t) => t.name),\n      },\n    },\n    children: {\n      upButton: {\n        label: \"Up Button\",\n        fields: {\n          field: {\n            label: \"Field\",\n            input: \"select\",\n            value: config.upButton.field,\n            options: geometryMsgOptions,\n          },\n          value: { label: \"Value\", input: \"number\", value: config.upButton.value },\n        },\n      },\n      downButton: {\n        label: \"Down Button\",\n        fields: {\n          field: {\n            label: \"Field\",\n            input: \"select\",\n            value: config.downButton.field,\n            options: geometryMsgOptions,\n          },\n          value: { label: \"Value\", input: \"number\", value: config.downButton.value },\n        },\n      },\n      leftButton: {\n        label: \"Left Button\",\n        fields: {\n          field: {\n            label: \"Field\",\n            input: \"select\",\n            value: config.leftButton.field,\n            options: geometryMsgOptions,\n          },\n          value: { label: \"Value\", input: \"number\", value: config.leftButton.value },\n        },\n      },\n      rightButton: {\n        label: \"Right Button\",\n        fields: {\n          field: {\n            label: \"Field\",\n            input: \"select\",\n            value: config.rightButton.field,\n            options: geometryMsgOptions,\n          },\n          value: { label: \"Value\", input: \"number\", value: config.rightButton.value },\n        },\n      },\n    },\n  };\n\n  return { general };\n}\n\nfunction TeleopPanel(props: TeleopPanelProps): JSX.Element {\n  const { context } = props;\n  const { saveState } = context;\n\n  const [currentAction, setCurrentAction] = useState<DirectionalPadAction | undefined>();\n  const [topics, setTopics] = useState<readonly Topic[]>([]);\n\n  // resolve an initial config which may have some missing fields into a full config\n  const [config, setConfig] = useState<Config>(() => {\n    const partialConfig = context.initialState as DeepPartial<Config>;\n\n    const {\n      topic,\n      publishRate = 1,\n      upButton: { field: upField = \"linear-x\", value: upValue = 1 } = {},\n      downButton: { field: downField = \"linear-x\", value: downValue = -1 } = {},\n      leftButton: { field: leftField = \"angular-z\", value: leftValue = 1 } = {},\n      rightButton: { field: rightField = \"angular-z\", value: rightValue = -1 } = {},\n    } = partialConfig;\n\n    return {\n      topic,\n      publishRate,\n      upButton: { field: upField, value: upValue },\n      downButton: { field: downField, value: downValue },\n      leftButton: { field: leftField, value: leftValue },\n      rightButton: { field: rightField, value: rightValue },\n    };\n  });\n\n  const settingsActionHandler = useCallback((action: SettingsTreeAction) => {\n    if (action.action !== \"update\") {\n      return;\n    }\n\n    setConfig((previous) => {\n      const newConfig = { ...previous };\n      set(newConfig, action.payload.path.slice(1), action.payload.value);\n      return newConfig;\n    });\n  }, []);\n\n  // setup context render handler and render done handling\n  const [renderDone, setRenderDone] = useState<() => void>(() => () => {});\n  const [colorScheme, setColorScheme] = useState<\"dark\" | \"light\">(\"light\");\n  useLayoutEffect(() => {\n    context.watch(\"topics\");\n    context.watch(\"colorScheme\");\n\n    context.onRender = (renderState, done) => {\n      setTopics(renderState.topics ?? []);\n      setRenderDone(() => done);\n      if (renderState.colorScheme) {\n        setColorScheme(renderState.colorScheme);\n      }\n    };\n  }, [context]);\n\n  useEffect(() => {\n    const tree = buildSettingsTree(config, topics);\n    context.updatePanelSettingsEditor({\n      actionHandler: settingsActionHandler,\n      nodes: tree,\n    });\n    saveState(config);\n  }, [config, context, saveState, settingsActionHandler, topics]);\n\n  // advertise topic\n  const { topic: currentTopic } = config;\n  useLayoutEffect(() => {\n    if (!currentTopic) {\n      return;\n    }\n\n    context.advertise?.(currentTopic, \"geometry_msgs/Twist\", {\n      datatypes: new Map([\n        [\"geometry_msgs/Vector3\", ros1[\"geometry_msgs/Vector3\"]],\n        [\"geometry_msgs/Twist\", ros1[\"geometry_msgs/Twist\"]],\n      ]),\n    });\n\n    return () => {\n      context.unadvertise?.(currentTopic);\n    };\n  }, [context, currentTopic]);\n\n  useLayoutEffect(() => {\n    if (currentAction == undefined || !currentTopic) {\n      return;\n    }\n\n    const message = {\n      linear: {\n        x: 0,\n        y: 0,\n        z: 0,\n      },\n      angular: {\n        x: 0,\n        y: 0,\n        z: 0,\n      },\n    };\n\n    function setFieldValue(field: string, value: number) {\n      switch (field) {\n        case \"linear-x\":\n          message.linear.x = value;\n          break;\n        case \"linear-y\":\n          message.linear.y = value;\n          break;\n        case \"linear-z\":\n          message.linear.z = value;\n          break;\n        case \"angular-x\":\n          message.angular.x = value;\n          break;\n        case \"angular-y\":\n          message.angular.y = value;\n          break;\n        case \"angular-z\":\n          message.angular.z = value;\n          break;\n      }\n    }\n\n    switch (currentAction) {\n      case DirectionalPadAction.UP:\n        setFieldValue(config.upButton.field, config.upButton.value);\n        break;\n      case DirectionalPadAction.DOWN:\n        setFieldValue(config.downButton.field, config.downButton.value);\n        break;\n      case DirectionalPadAction.LEFT:\n        setFieldValue(config.leftButton.field, config.leftButton.value);\n        break;\n      case DirectionalPadAction.RIGHT:\n        setFieldValue(config.rightButton.field, config.rightButton.value);\n        break;\n      default:\n    }\n\n    // don't publish if rate is 0 or negative - this is a config error on user's part\n    if (config.publishRate <= 0) {\n      return;\n    }\n\n    const intervalMs = (1000 * 1) / config.publishRate;\n    context.publish?.(currentTopic, message);\n    const intervalHandle = setInterval(() => {\n      context.publish?.(currentTopic, message);\n    }, intervalMs);\n\n    return () => {\n      clearInterval(intervalHandle);\n    };\n  }, [context, config, currentTopic, currentAction]);\n\n  useLayoutEffect(() => {\n    renderDone();\n  }, [renderDone]);\n\n  const canPublish = context.publish != undefined && config.publishRate > 0;\n  const hasTopic = Boolean(currentTopic);\n  const enabled = canPublish && hasTopic;\n\n  return (\n    <ThemeProvider isDark={colorScheme === \"dark\"}>\n      <Stack\n        fullHeight\n        justifyContent=\"center\"\n        alignItems=\"center\"\n        style={{ padding: \"min(5%, 8px)\", textAlign: \"center\" }}\n      >\n        {!canPublish && (\n          <EmptyState>\n            Please connect to a datasource that supports publishing in order to use this panel\n          </EmptyState>\n        )}\n        {canPublish && !hasTopic && (\n          <EmptyState>Please select a publish topic in the panel settings</EmptyState>\n        )}\n        {enabled && <DirectionalPad onAction={setCurrentAction} disabled={!enabled} />}\n      </Stack>\n    </ThemeProvider>\n  );\n}\n\nexport default TeleopPanel;\n","// This Source Code Form is subject to the terms of the Mozilla Public\n// License, v2.0. If a copy of the MPL was not distributed with this\n// file, You can obtain one at http://mozilla.org/MPL/2.0/\n\nimport { StrictMode, useMemo } from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { useCrash } from \"@foxglove/hooks\";\nimport { PanelExtensionContext } from \"@foxglove/studio\";\nimport { CaptureErrorBoundary } from \"@foxglove/studio-base/components/CaptureErrorBoundary\";\nimport Panel from \"@foxglove/studio-base/components/Panel\";\nimport { PanelExtensionAdapter } from \"@foxglove/studio-base/components/PanelExtensionAdapter\";\nimport { SaveConfig } from \"@foxglove/studio-base/types/panels\";\n\nimport TeleopPanel from \"./TeleopPanel\";\n\nfunction initPanel(crash: ReturnType<typeof useCrash>, context: PanelExtensionContext) {\n  ReactDOM.render(\n    <StrictMode>\n      <CaptureErrorBoundary onError={crash}>\n        <TeleopPanel context={context} />\n      </CaptureErrorBoundary>\n    </StrictMode>,\n    context.panelElement,\n  );\n  return () => {\n    ReactDOM.unmountComponentAtNode(context.panelElement);\n  };\n}\n\ntype Props = {\n  config: unknown;\n  saveConfig: SaveConfig<unknown>;\n};\n\nfunction TeleopPanelAdapter(props: Props) {\n  const crash = useCrash();\n  const boundInitPanel = useMemo(() => initPanel.bind(undefined, crash), [crash]);\n\n  return (\n    <PanelExtensionAdapter\n      config={props.config}\n      saveConfig={props.saveConfig}\n      initPanel={boundInitPanel}\n      highestSupportedConfigVersion={1}\n    />\n  );\n}\n\nTeleopPanelAdapter.panelType = \"Teleop\";\nTeleopPanelAdapter.defaultConfig = {};\n\nexport default Panel(TeleopPanelAdapter);\n"],"names":["CaptureErrorBoundary","error","useStyles","theme","_params","classes","DirectionalPadAction","DirectionalPad","props","onAction","disabled","currentAction","setCurrentAction","cx","handleMouseDown","action","handleMouseUp","makeMouseHandlers","Stack","geometryMsgOptions","buildSettingsTree","config","topics","t","TeleopPanel","context","saveState","setTopics","setConfig","partialConfig","topic","publishRate","upField","upValue","downField","downValue","leftField","leftValue","rightField","rightValue","settingsActionHandler","previous","newConfig","renderDone","setRenderDone","colorScheme","setColorScheme","renderState","done","tree","currentTopic","message","setFieldValue","field","value","intervalMs","intervalHandle","canPublish","hasTopic","enabled","ThemeProvider","EmptyState","initPanel","crash","TeleopPanelAdapter","boundInitPanel","PanelExtensionAdapter","Panel"],"sourceRoot":""}