"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4933],{96133:(te,B,n)=>{n.d(B,{J:()=>t});function t(S,R){if(typeof S.value=="object")throw new Error("filterMatches only works on paths where global variables have been filled in");if(S.value==null)return!1;let u=R;for(const U of S.path)if(typeof u!="object"||u==null||(u=u[U],u==null))return!1;return u!=null&&u==S.value}},36922:(te,B,n)=>{n.d(B,{Iq:()=>V,wm:()=>_});var t=n(76635),S=n.n(t),R=n(2784),u=n(7506),U=n(59506),Y=n(36423),L=n(35528),G=n(96133),k=n(60351),H=n(94670),z=n(1012);function V(E){const{topics:d,datatypes:s}=U.Ui(),{globalVariables:x}=(0,Y.Z)(),l=(0,u.O4)(E),D=(0,R.useMemo)(()=>{const a={};for(const o of l){const r=(0,z.ZP)(o);r&&(a[o]=J(r,x))}return a},[x,l]),N=(0,u.vE)(D),v=(0,R.useMemo)(()=>{const a=(0,L.N_)(d),o=new Set,r=[];for(const h of l){const c=(0,z.ZP)(h);if(c){if(o.has(c.topicName))continue;o.add(c.topicName);const P=a[c.topicName];P&&r.push(P)}}return r},[d,l]),b=(0,u.vE)(v),g=(0,R.useMemo)(()=>{const a=new Map;function o(r,h){if(h.includes(r))return;const c=s.get(r);if(c){a.set(r,c);for(const P of c.definitions)(P.isComplex===!0||(0,L.bV)(P.name)!=null)&&o(P.type,[...h,r])}}for(const{schemaName:r}of b.values())r!=null&&o(r,[]);return a},[s,b]),y=(0,u.vE)(g),j=(0,R.useRef)({});if((0,u.br)([b,y],{initiallyTrue:!0})&&(j.current={}),(0,u.br)([N],{initiallyTrue:!1}))for(const[a,o]of Object.entries(j.current)){const r=N[a];(!r||!(0,t.isEqual)(o.filledInPath,r))&&delete j.current[a]}return(0,R.useCallback)((a,o)=>{if(!l.includes(a))throw new Error(`path (${a}) was not in the list of cached paths`);const r=N[a];if(!r)return;const h=j.current[a]=j.current[a]??{filledInPath:r,weakMap:new WeakMap},{weakMap:c}=h;if(!c.has(o)){const A=q(o,r,b,y);return c.set(o,A),A}return c.get(o)},[y,N,l,b])}function J(E,d){return{...E,messagePath:E.messagePath.map(s=>{if(s.type==="slice"){const x=typeof s.start=="object"?Number(d[s.start.variableName]):s.start,l=typeof s.end=="object"?Number(d[s.end.variableName]):s.end;return{...s,start:isNaN(x)?0:x,end:isNaN(l)?1/0:l}}else if(s.type==="filter"&&typeof s.value=="object"){let x;const l=d[s.value.variableName];return(typeof l=="number"||typeof l=="string")&&(x=l),{...s,value:x}}return s})}}function q(E,d,s,x){const l=(0,H.pb)(x),D=(0,L.N_)(s)[d.topicName];if(!D||E.topic!==d.topicName)return;for(const g of d.messagePath)if(g.type==="filter"){if(!(0,G.J)(g,E.message))return[]}else break;const N=[];function v(g,y,j,a){if(g==null||a==null)return;const o=d.messagePath[y],r=d.messagePath[y+1];if(o)if(o.type==="name"&&a.structureType==="message"){const h=a.nextByName[o.name];v(g[o.name],y+1,`${j}.${o.repr}`,h)}else if(o.type==="slice"&&a.structureType==="array"){const{start:h,end:c}=o;if(typeof h=="object"||typeof c=="object")throw new Error("getMessagePathDataItems only works on paths where global variables have been filled in");const P=h,A=c;if(typeof P!="number"||typeof A!="number")return;const X=g.length;for(let T=P;T<=Math.min(A,X-1);T++){const ee=T>=0?T:X+T,e=g[ee];if(e==null)continue;let f;if(r&&r.type==="filter")f=`${j}[:]`;else if(typeof e=="object"){const i=k.H.find(m=>m in e);i!=null?f=`${j}[:]{${i}==${e[i]}}`:f=`${j}[${T}]`}else f=`${j}[${T}]`;v(e,y+1,f,a.next)}}else o.type==="filter"?(0,G.J)(o,g)&&v(g,y+1,`${j}{${o.repr}}`,a):console.warn(`Unknown pathItem.type ${o.type} for structureType: ${a.structureType}`);else{let h;const c=d.messagePath[y-1];if(c&&c.type==="name"){const P=c.name;h=(0,L.Hh)(x)[a.datatype]?.[P]?.[g]}N.push({value:g,path:j,constantName:h})}}const b=D.schemaName==null?{structureType:"message",datatype:"",nextByName:{}}:l[D.schemaName];return b&&v(E.message,0,(0,z.dH)(d.topicName),b),N}function _(E){const d=(0,u.O4)(E),s=V(d);return(0,R.useCallback)(x=>{const l={};for(const D of d){const N=(0,z.ZP)(D);if(!N){l[D]=[];continue}const v=x[N.topicName];if(!v)continue;const b=[];l[D]=b;for(const g of v){const y=s(D,g);y&&b.push({messageEvent:g,queriedData:y})}}return l},[d,s])}},44933:(te,B,n)=>{n.r(B),n.d(B,{default:()=>ee});var t=n(52322),S=n(8740),R=n(59506),u=n(29268),U=n(43684),Y=n(1012),L=n(36922),G=n(14075),k=n(76479),H=n(93812),z=n(77075),V=n(71963),J=n(59169),q=n(23468),_=n(31373),E=n(36673),d=n(24544),s=n(87037),x=n(36754),l=n(68434),D=n(29800),N=n(80078),v=n(73705),b=n(95412);function g(e){return e.replace(/\./g,"-")}var y=n(2784);const j=(0,S.ZL)()(e=>({objectCell:{fontStyle:"italic",cursor:"pointer"},iconButton:{marginTop:e.spacing(-.5),marginLeft:e.spacing(-.5),"&:hover":{backgroundColor:"transparent"}}}));function a({row:e,accessorPath:f,children:i}){const{classes:m}=j(),[Z,I]=y.useState(!1),C=y.useCallback(()=>I($=>!$),[]);return e.getIsExpanded()||Z?(0,t.jsxs)("div",{children:[Z&&(0,t.jsx)(s.Z,{size:"small",onClick:C,className:m.iconButton,children:(0,t.jsx)(J.Z,{fontSize:"small"})}),i]}):(0,t.jsx)("span",{className:m.objectCell,"data-testid":`expand-cell-${g(f)}-${e.index}`,onClick:C,children:"Object"})}var o=n(2784);const r=(0,S.ZL)()((e,f,i)=>({table:{border:"none",width:"100%",borderCollapse:"collapse",borderSpacing:0},tableRow:{svg:{opacity:.6},"&:nth-of-type(even)":{backgroundColor:e.palette.action.hover},"&:hover":{backgroundColor:e.palette.action.focus,[`.${i.tableData}`]:{backgroundColor:e.palette.action.hover,cursor:"pointer"},svg:{opacity:.8}},[`.${i.tableHeader}:first-of-type`]:{paddingTop:e.spacing(.5),paddingBottom:e.spacing(.5)}},tableData:{padding:`${e.spacing(.5)} !important`,whiteSpace:"nowrap",textOverflow:"ellipsis",verticalAlign:"top",border:`1px solid ${e.palette.divider}`,lineHeight:"1.3em"},tableHeader:{color:e.palette.text.primary,verticalAlign:"top",border:`1px solid ${e.palette.divider}`,lineHeight:"1.3em",borderLeftColor:"transparent",borderRightColor:"transparent",padding:e.spacing(.5),fontWeight:"bold !important",cursor:"pointer",width:"auto",textAlign:"left","&#expander":{width:28}},sortAsc:{borderBottomColor:e.palette.primary.main},sortDesc:{borderTopColor:e.palette.primary.main},iconButton:{margin:e.spacing(-.5),"&:hover":{backgroundColor:"transparent"}}})),h=(0,v.Cl)();function c(e,f,i){const m=e.toJSON?.()??e,Z=Object.keys(m).map(I=>{const C=f.length!==0?`${f}.${I}`:I;return h.accessor(I,{header:I,id:C,cell:$=>{const O=$.getValue(),p=$.row;return Array.isArray(O)&&typeof O[0]!="object"?JSON.stringify(O):typeof O=="object"&&O!=null?(0,t.jsx)(a,{row:p,accessorPath:C,children:(0,t.jsx)(P,{value:O,accessorPath:f})}):`${O}`}})});if(f.length===0){const I=h.display({id:"expander",header:"",cell:({row:C})=>(0,t.jsx)(s.Z,{className:i,size:"small","data-testid":`expand-row-${C.index}`,onClick:()=>C.toggleExpanded(),children:C.getIsExpanded()?(0,t.jsx)(J.Z,{fontSize:"small"}):(0,t.jsx)(V.Z,{fontSize:"small"})})});Z.unshift(I)}return Z}function P({value:e,accessorPath:f}){const i=f.length>0,{classes:m,cx:Z}=r(),I=o.useMemo(()=>{if(e==null||typeof e!="object"||Array.isArray(e)&&typeof e[0]!="object"&&e[0]!=null)return[];const M=Array.isArray(e)?e[0]??{}:e;return c(M,f,m.iconButton)},[f,m.iconButton,e]),C=o.useMemo(()=>Array.isArray(e)?e:[e],[e]),[$,O]=o.useState({}),p=(0,b.b7)({autoResetExpanded:!1,columns:I,data:C,getCoreRowModel:(0,v.sC)(),getExpandedRowModel:(0,v.rV)(),getPaginationRowModel:i?(0,v.G_)():void 0,getSortedRowModel:(0,v.tj)(),initialState:{pagination:{pageSize:30}},onExpandedChange:O,state:{expanded:$}});if(typeof e!="object"||e==null||!i&&Array.isArray(e)&&typeof e[0]!="object")return(0,t.jsx)(u.Z,{children:"Cannot render primitive values in a table. Try using the Raw Messages panel instead."});const{pagination:{pageIndex:w,pageSize:W}}=p.getState();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("table",{className:m.table,children:[(0,t.jsx)("thead",{children:p.getHeaderGroups().map((M,Q)=>(0,t.jsx)("tr",{className:m.tableRow,children:M.headers.map(K=>{const F=K.column;return(0,t.jsx)("th",{className:Z(m.tableHeader,{[m.sortAsc]:F.getIsSorted()==="asc",[m.sortDesc]:F.getIsSorted()==="desc"}),id:F.id,onClick:K.column.getToggleSortingHandler(),"data-testid":`column-header-${g(F.id)}`,children:(0,b.ie)(K.column.columnDef.header,K)},F.id)})},Q))}),(0,t.jsx)("tbody",{children:p.getRowModel().rows.slice(w*W,(w+1)*W).map(M=>(0,t.jsx)("tr",{className:m.tableRow,children:M.getVisibleCells().map((Q,K)=>(0,t.jsx)("td",{className:m.tableData,children:(0,b.ie)(Q.column.columnDef.cell,Q.getContext())},K))},M.index))})]}),!i&&(0,t.jsx)(x.Z,{maxWidth:"xs",disableGutters:!0,children:(0,t.jsxs)(H.Z,{direction:"row",flexWrap:"wrap",gap:1,paddingX:.5,paddingTop:.5,alignItems:"center",children:[(0,t.jsx)(s.Z,{onClick:()=>p.setPageIndex(0),disabled:!p.getCanPreviousPage(),children:(0,t.jsx)(E.Z,{fontSize:"small"})}),(0,t.jsx)(s.Z,{onClick:()=>p.previousPage(),disabled:!p.getCanPreviousPage(),children:(0,t.jsx)(q.Z,{fontSize:"small"})}),(0,t.jsxs)(l.Z,{flex:"auto",variant:"inherit",align:"center",noWrap:!0,children:["Page"," ",(0,t.jsxs)("strong",{children:[p.getState().pagination.pageIndex+1," of ",p.getPageOptions().length]})]}),(0,t.jsx)(s.Z,{onClick:()=>p.nextPage(),disabled:!p.getCanNextPage(),children:(0,t.jsx)(_.Z,{fontSize:"small"})}),(0,t.jsx)(s.Z,{onClick:()=>p.setPageIndex(p.getPageCount()-1),disabled:!p.getCanNextPage(),children:(0,t.jsx)(d.Z,{fontSize:"small"})}),(0,t.jsx)(D.Z,{value:W,size:"small",onChange:M=>p.setPageSize(Number(M.target.value)),MenuProps:{MenuListProps:{dense:!0}},children:[10,20,30,40,50].map(M=>(0,t.jsx)(N.Z,{value:M,children:`Show ${M}`},M))})]})})]})}var A=n(2784);const X=(0,S.ZL)()({inputWrapper:{width:"100%",lineHeight:"20px"},monospace:{fontFamily:z.R.MONOSPACE}});function T({config:e,saveConfig:f}){const{topicPath:i}=e,{classes:m}=X(),Z=A.useCallback(M=>f({topicPath:M}),[f]),C=A.useMemo(()=>(0,Y.ZP)(i),[i])?.topicName??"",$=(0,R.V7)({topics:[C],historySize:1})[C],O=(0,L.Iq)([i]),p=$?.[0],w=p?O(i,p)??[]:[],W=w[0];return(0,t.jsxs)(H.Z,{flex:"auto",overflow:"hidden",position:"relative",children:[(0,t.jsx)(k.Z,{children:(0,t.jsx)("div",{className:m.inputWrapper,children:(0,t.jsx)(U.ZP,{index:0,path:i,onChange:Z,inputStyle:{height:20}})})}),i.length===0&&(0,t.jsx)(u.Z,{children:"No topic selected"}),i.length!==0&&w.length===0&&(0,t.jsx)(u.Z,{children:"Waiting for next message"}),i.length!==0&&W&&(0,t.jsx)(H.Z,{overflow:"auto",className:m.monospace,children:(0,t.jsx)(P,{value:W.value,accessorPath:""})})]})}T.panelType="Table",T.defaultConfig={topicPath:""};const ee=(0,G.Z)(T)}}]);

//# sourceMappingURL=studio-4933.js.map