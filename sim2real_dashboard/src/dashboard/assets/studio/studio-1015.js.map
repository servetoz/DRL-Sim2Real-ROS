{"version":3,"file":"studio-1015.js","mappings":"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","sources":["webpack:///../../packages/studio-base/src/components/ExpandingToolbar.tsx","webpack:///../../packages/studio-base/src/panels/TopicGraph/Graph.tsx","webpack:///../../packages/studio-base/src/panels/TopicGraph/index.tsx"],"sourcesContent":["// This Source Code Form is subject to the terms of the Mozilla Public\n// License, v2.0. If a copy of the MPL was not distributed with this\n// file, You can obtain one at http://mozilla.org/MPL/2.0/\n\nimport { ArrowMinimize24Filled } from \"@fluentui/react-icons\";\nimport {\n  Paper,\n  IconButton,\n  Tabs,\n  Tab,\n  svgIconClasses,\n  tabClasses,\n  tabsClasses,\n} from \"@mui/material\";\nimport { ReactElement, ReactNode } from \"react\";\nimport { makeStyles } from \"tss-react/mui\";\n\nimport Stack from \"@foxglove/studio-base/components/Stack\";\n\nconst PANE_HEIGHT = 240;\n\nconst useStyles = makeStyles()((theme) => ({\n  root: {\n    pointerEvents: \"auto\",\n    backgroundColor: theme.palette.background.default,\n    width: 280,\n  },\n  content: {\n    position: \"relative\",\n  },\n  iconButton: {\n    fontSize: \"1rem !important\",\n\n    [`& svg:not(.${svgIconClasses.root})`]: {\n      fontSize: \"1rem !important\",\n    },\n  },\n  tabs: {\n    minHeight: \"auto\",\n\n    [`.${tabsClasses.indicator}`]: {\n      transform: \"scaleX(0.75)\",\n      height: 2,\n    },\n    [`.${tabClasses.root}`]: {\n      minHeight: \"auto\",\n      minWidth: \"auto\",\n      padding: theme.spacing(1, 1.5, 1.125),\n      color: theme.palette.text.secondary,\n\n      \"&.Mui-selected\": {\n        color: theme.palette.text.primary,\n      },\n    },\n  },\n}));\n\nexport function ToolGroup<T>({ children }: { name: T; children: React.ReactElement }): JSX.Element {\n  return children;\n}\n\nexport function ToolGroupFixedSizePane({ children }: { children: ReactNode }): JSX.Element {\n  return (\n    <Stack padding={1} overflowX=\"hidden\" overflowY=\"auto\" style={{ maxHeight: PANE_HEIGHT }}>\n      {children}\n    </Stack>\n  );\n}\n\ntype Props<T extends string> = {\n  checked?: boolean;\n  children: React.ReactElement<typeof ToolGroup>[] | React.ReactElement<typeof ToolGroup>;\n  icon: ReactNode;\n  onSelectTab: (name: T | undefined) => void;\n  selectedTab?: T; // collapse the toolbar if selectedTab is undefined\n  tooltip: string;\n  dataTest?: string;\n};\n\nexport default function ExpandingToolbar<T extends string>({\n  children,\n  checked,\n  icon,\n  onSelectTab,\n  selectedTab,\n  tooltip,\n  dataTest,\n}: Props<T>): JSX.Element {\n  const { classes } = useStyles();\n  const expanded = selectedTab != undefined;\n\n  if (!expanded) {\n    let selectedTabLocal: T | undefined = selectedTab;\n    // default to the first child's name if no tab is selected\n    React.Children.forEach(children, (child) => {\n      if (selectedTabLocal == undefined) {\n        selectedTabLocal = child.props.name as T;\n      }\n    });\n\n    return (\n      <Paper square={false} elevation={4} style={{ pointerEvents: \"auto\" }}>\n        <IconButton\n          className={classes.iconButton}\n          color={checked === true ? \"info\" : \"default\"}\n          title={tooltip}\n          data-testid={`ExpandingToolbar-${tooltip}`}\n          onClick={() => onSelectTab(selectedTabLocal)}\n        >\n          {icon}\n        </IconButton>\n      </Paper>\n    );\n  }\n  let selectedChild: ReactElement | undefined;\n\n  React.Children.forEach(children, (child) => {\n    if (!selectedChild || child.props.name === selectedTab) {\n      selectedChild = child;\n    }\n  });\n\n  const handleChange = (_event: React.SyntheticEvent, value: T | undefined) => {\n    if (value != undefined) {\n      onSelectTab(value);\n    }\n  };\n\n  return (\n    <Paper className={classes.root} data-testid={dataTest} square={false} elevation={4}>\n      <Paper>\n        <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\">\n          <Tabs\n            className={classes.tabs}\n            textColor=\"inherit\"\n            value={selectedTab}\n            onChange={handleChange}\n          >\n            {React.Children.map(children, (child) => (\n              <Tab label={child.props.name} value={child.props.name} />\n            ))}\n          </Tabs>\n          <IconButton className={classes.iconButton} onClick={() => onSelectTab(undefined)}>\n            <ArrowMinimize24Filled />\n          </IconButton>\n        </Stack>\n      </Paper>\n      <div className={classes.content}>{selectedChild}</div>\n    </Paper>\n  );\n}\n","// This Source Code Form is subject to the terms of the Mozilla Public\n// License, v2.0. If a copy of the MPL was not distributed with this\n// file, You can obtain one at http://mozilla.org/MPL/2.0/\n\nimport Cytoscape from \"cytoscape\";\nimport CytoscapeDagre from \"cytoscape-dagre\";\nimport { MutableRefObject, useEffect, useRef } from \"react\";\n\nCytoscape.use(CytoscapeDagre);\nCytoscape.warnings(false);\n\nconst DAG_LAYOUT = {\n  name: \"dagre\",\n  fit: false,\n  nodesep: 20,\n  rankDir: \"TB\",\n  ranker: \"longest-path\",\n};\n\nexport interface GraphMutation {\n  fit: () => void;\n  resetUserPanZoom: () => void;\n}\n\ntype Props = {\n  style: Cytoscape.Stylesheet[];\n  elements: cytoscape.ElementDefinition[];\n  rankDir: string;\n  graphRef: MutableRefObject<GraphMutation | undefined>;\n};\n\nexport default function Graph(props: Props): JSX.Element {\n  const cy = useRef<Cytoscape.Core>();\n  const graphRef = useRef<HTMLDivElement>(ReactNull);\n\n  // indicates that a user has manually panned/zoomed the viewport\n  // we avoid performing actions like automatic fit when this happens.\n  const userPanZoom = useRef<boolean>(false);\n\n  useEffect(() => {\n    if (!graphRef.current) {\n      throw new Error(\"Graph ref must be available on first render\");\n    }\n\n    cy.current = Cytoscape({\n      container: graphRef.current,\n      zoom: 0.7,\n    });\n\n    cy.current.on(\"viewport\", () => {\n      userPanZoom.current = true;\n    });\n\n    props.graphRef.current = {\n      fit: () => {\n        userPanZoom.current = false;\n        cy.current?.fit();\n      },\n      resetUserPanZoom: () => {\n        userPanZoom.current = false;\n      },\n    };\n\n    return () => {\n      cy.current?.destroy();\n    };\n  }, [props.graphRef]);\n\n  const { elements, rankDir } = props;\n  useEffect(() => {\n    if (!cy.current) {\n      return;\n    }\n\n    cy.current.batch(() => {\n      cy.current?.elements().remove();\n      cy.current?.add(elements);\n      cy.current\n        ?.elements()\n        .makeLayout({ ...DAG_LAYOUT, rankDir } as unknown as Cytoscape.LayoutOptions)\n        .run();\n    });\n\n    if (!userPanZoom.current) {\n      cy.current.fit();\n    }\n  }, [elements, rankDir]);\n\n  useEffect(() => {\n    cy.current?.style(props.style);\n  }, [props.style]);\n\n  return <div ref={graphRef} style={{ width: \"100%\", height: \"100%\" }} />;\n}\n","// This Source Code Form is subject to the terms of the Mozilla Public\n// License, v2.0. If a copy of the MPL was not distributed with this\n// file, You can obtain one at http://mozilla.org/MPL/2.0/\n//\n// This file incorporates work covered by the following copyright and\n// permission notice:\n//\n//   Copyright 2019-2021 Cruise LLC\n//\n//   This source code is licensed under the Apache License, Version 2.0,\n//   found at http://www.apache.org/licenses/LICENSE-2.0\n//   You may not use this file except in compliance with the License.\n\nimport {\n  ArrowBidirectionalUpDown16Regular,\n  PageFit16Regular,\n  RectangleLandscape16Regular,\n  Diamond32Filled,\n} from \"@fluentui/react-icons\";\nimport { FormControlLabel, IconButton, Paper, Radio, RadioGroup } from \"@mui/material\";\nimport Cytoscape from \"cytoscape\";\nimport { useCallback, useMemo, useRef, useState } from \"react\";\nimport textMetrics from \"text-metrics\";\nimport { makeStyles } from \"tss-react/mui\";\n\nimport EmptyState from \"@foxglove/studio-base/components/EmptyState\";\nimport ExpandingToolbar, { ToolGroup } from \"@foxglove/studio-base/components/ExpandingToolbar\";\nimport { useMessagePipeline } from \"@foxglove/studio-base/components/MessagePipeline\";\nimport Panel from \"@foxglove/studio-base/components/Panel\";\nimport PanelToolbar, {\n  PANEL_TOOLBAR_MIN_HEIGHT,\n} from \"@foxglove/studio-base/components/PanelToolbar\";\nimport Stack from \"@foxglove/studio-base/components/Stack\";\n\nimport Graph, { GraphMutation } from \"./Graph\";\n\nconst LABEL_MAX_WIDTH = 200;\nconst STYLESHEET: Cytoscape.Stylesheet[] = [\n  {\n    selector: \"edge\",\n    style: {\n      \"target-arrow-shape\": \"triangle\",\n      \"line-color\": \"rgb(190, 190, 187)\",\n      \"target-arrow-color\": \"rgb(190, 190, 187)\",\n      \"curve-style\": \"bezier\",\n    },\n  },\n  {\n    selector: 'node[type=\"node\"]',\n    style: {\n      content: \"data(label)\",\n      shape: \"round-rectangle\",\n      height: \"20px\",\n      \"background-color\": \"#000\",\n      \"border-color\": \"rgb(69, 165, 255)\",\n      \"border-width\": \"1px\",\n      \"padding-top\": \"4px\",\n      \"padding-right\": \"4px\",\n      \"padding-bottom\": \"4px\",\n      \"padding-left\": \"4px\",\n      \"font-size\": \"16px\",\n      \"text-max-width\": `${LABEL_MAX_WIDTH}px`,\n      \"text-wrap\": \"ellipsis\",\n      \"text-valign\": \"center\",\n      \"text-halign\": \"center\",\n      color: \"rgb(69, 165, 255)\",\n    },\n  },\n  {\n    selector: 'node[type=\"topic\"]',\n    style: {\n      content: \"data(label)\",\n      shape: \"diamond\",\n      width: \"40px\",\n      height: \"40px\",\n      \"background-color\": \"rgb(183, 157, 202)\",\n      \"font-size\": \"16px\",\n      \"text-outline-color\": \"#000\",\n      \"text-outline-width\": \"2px\",\n      color: \"#fff\",\n    },\n  },\n  {\n    selector: 'node[type=\"service\"]',\n    style: {\n      content: \"data(label)\",\n      shape: \"round-rectangle\",\n      height: \"20px\",\n      \"background-color\": \"#000\",\n      \"border-color\": \"rgb(255, 107, 130)\",\n      \"border-width\": \"1px\",\n      \"padding-top\": \"4px\",\n      \"padding-right\": \"4px\",\n      \"padding-bottom\": \"4px\",\n      \"padding-left\": \"4px\",\n      \"font-size\": \"16px\",\n      \"text-max-width\": \"200px\",\n      \"text-wrap\": \"ellipsis\",\n      \"text-valign\": \"center\",\n      \"text-halign\": \"center\",\n      color: \"rgb(255, 107, 130)\",\n    },\n  },\n];\n\nconst useStyles = makeStyles()((theme) => ({\n  root: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"flex-end\",\n    position: \"absolute\",\n    top: `calc(${PANEL_TOOLBAR_MIN_HEIGHT}px + ${theme.spacing(1)})`,\n    right: theme.spacing(1),\n    zIndex: 101,\n    gap: theme.spacing(1),\n    // allow mouse events to pass through the empty space in this container element\n    pointerEvents: \"none\",\n  },\n  stack: {\n    \"& > .MuiIconButton-root\": {\n      \"&:not(:first-of-type)\": {\n        borderTopRightRadius: 0,\n        borderTopLeftRadius: 0,\n      },\n      \"&:not(:last-child)\": {\n        borderBottomRightRadius: 0,\n        borderBottomLeftRadius: 0,\n      },\n    },\n  },\n  icon: {\n    fontSize: \"1rem !important\",\n\n    \"& svg:not(.MuiSvgIcon-root)\": {\n      fontSize: \"1rem !important\",\n    },\n  },\n  pointerEventsAuto: {\n    pointerEvents: \"auto\",\n  },\n  toolbarContent: {\n    padding: theme.spacing(1),\n  },\n}));\n\nexport type TopicVisibility =\n  | \"all\"\n  | \"none\"\n  | \"published\"\n  | \"subscribed\"\n  | \"connected\"\n  | \"disconnected-pub\"\n  | \"disconnected-sub\";\n\nconst topicVisibilityToLabelMap: Record<TopicVisibility, string> = {\n  all: \"All topics\",\n  none: \"No topics\",\n  published: \"Published topics\",\n  subscribed: \"Subscribed topics\",\n  connected: \"Connected topics\",\n  \"disconnected-pub\": \"Disconnected published topics\",\n  \"disconnected-sub\": \"Disconnected subscribed topics\",\n};\n\nfunction unionInto<T>(dest: Set<T>, ...iterables: ReadonlySet<T>[]): void {\n  for (const iterable of iterables) {\n    for (const item of iterable) {\n      dest.add(item);\n    }\n  }\n}\n\nfunction TopicGraph() {\n  const { classes, cx } = useStyles();\n  const [selectedTab, setSelectedTab] = useState<\"Topics\" | undefined>(undefined);\n\n  const publishedTopics = useMessagePipeline(\n    useCallback((ctx) => ctx.playerState.activeData?.publishedTopics, []),\n  );\n\n  const subscribedTopics = useMessagePipeline(\n    useCallback((ctx) => ctx.playerState.activeData?.subscribedTopics, []),\n  );\n\n  const services = useMessagePipeline(\n    useCallback((ctx) => ctx.playerState.activeData?.services, []),\n  );\n\n  const [lrOrientation, setLROrientation] = useState<boolean>(false);\n  const [showServices, setShowServices] = useState<boolean>(true);\n  const [topicVisibility, setTopicVisibility] = useState<TopicVisibility>(\"all\");\n\n  const textMeasure = useMemo(\n    () =>\n      textMetrics.init({\n        fontFamily: \"Arial\",\n        fontSize: \"16px\",\n      }),\n    [],\n  );\n\n  const topicPassesConditions = useCallback(\n    ({\n      topicIdWithSubscriptions,\n      topic,\n    }: {\n      topicIdWithSubscriptions: Set<string>;\n      topic: string;\n    }): boolean => {\n      const publishedTopicsWithFallback = publishedTopics ?? new Map([]);\n      const published = publishedTopicsWithFallback.has(topic);\n      const subscribed = topicIdWithSubscriptions.has(topic);\n\n      if (topicVisibility === \"none\") {\n        return false;\n      }\n      return (\n        topicVisibility === \"all\" ||\n        (topicVisibility === \"published\" && published) ||\n        (topicVisibility === \"subscribed\" && subscribed) ||\n        (topicVisibility === \"connected\" && published && subscribed) ||\n        (topicVisibility === \"disconnected-pub\" && published && !subscribed) ||\n        (topicVisibility === \"disconnected-sub\" && subscribed && !published)\n      );\n    },\n    [publishedTopics, topicVisibility],\n  );\n\n  const elements = useMemo<cytoscape.ElementDefinition[]>(() => {\n    const output: cytoscape.ElementDefinition[] = [];\n    const nodeIds = new Set<string>();\n    const topicIds = new Set<string>();\n    const topicIdWithSubscriptions = new Set<string>();\n    const serviceIds = new Set<string>();\n    if (publishedTopics != undefined) {\n      publishedTopics.forEach((curNodes, topic) => {\n        unionInto(nodeIds, curNodes);\n        topicIds.add(topic);\n      });\n    }\n    if (subscribedTopics != undefined) {\n      subscribedTopics.forEach((curNodes, topic) => {\n        unionInto(nodeIds, curNodes);\n        topicIds.add(topic);\n        topicIdWithSubscriptions.add(topic);\n      });\n    }\n    if (services != undefined) {\n      services.forEach((curNodes, topic) => {\n        unionInto(nodeIds, curNodes);\n        serviceIds.add(topic);\n      });\n    }\n\n    for (const node of nodeIds) {\n      const widthPx = Math.min(LABEL_MAX_WIDTH, textMeasure.width(node));\n      output.push({\n        style: { width: `${widthPx}px` },\n        data: { id: `n:${node}`, label: node, type: \"node\" },\n      });\n    }\n    if (topicVisibility !== \"none\") {\n      for (const topic of topicIds) {\n        if (!topicPassesConditions({ topicIdWithSubscriptions, topic })) {\n          continue;\n        }\n        output.push({\n          data: { id: `t:${topic}`, label: topic, type: \"topic\" },\n        });\n      }\n    }\n    if (showServices) {\n      for (const service of serviceIds) {\n        const widthPx = Math.min(LABEL_MAX_WIDTH, textMeasure.width(service));\n        output.push({\n          style: { width: `${widthPx}px` },\n          data: { id: `s:${service}`, label: service, type: \"service\" },\n        });\n      }\n    }\n\n    switch (topicVisibility) {\n      case \"none\":\n        if (publishedTopics == undefined || subscribedTopics == undefined) {\n          break;\n        }\n        for (const [topic, publishers] of publishedTopics.entries()) {\n          for (const pubNode of publishers) {\n            for (const subNode of subscribedTopics.get(topic) ?? []) {\n              if (subNode === pubNode) {\n                continue;\n              }\n              const source = `n:${pubNode}`;\n              const target = `n:${subNode}`;\n              output.push({ data: { id: `${source}-${target}`, source, target } });\n            }\n          }\n        }\n        break;\n      default:\n        if (publishedTopics != undefined) {\n          for (const [topic, publishers] of publishedTopics.entries()) {\n            if (!topicPassesConditions({ topicIdWithSubscriptions, topic })) {\n              continue;\n            }\n\n            for (const node of publishers) {\n              const source = `n:${node}`;\n              const target = `t:${topic}`;\n              output.push({ data: { id: `${source}-${target}`, source, target } });\n            }\n          }\n        }\n\n        if (subscribedTopics != undefined) {\n          for (const [topic, subscribers] of subscribedTopics.entries()) {\n            if (!topicPassesConditions({ topicIdWithSubscriptions, topic })) {\n              continue;\n            }\n\n            for (const node of subscribers) {\n              const source = `t:${topic}`;\n              const target = `n:${node}`;\n              output.push({ data: { id: `${source}-${target}`, source, target } });\n            }\n          }\n        }\n    }\n\n    if (showServices && services != undefined) {\n      for (const [service, providers] of services.entries()) {\n        for (const node of providers) {\n          output.push({ data: { source: `n:${node}`, target: `s:${service}` } });\n        }\n      }\n    }\n\n    return output;\n  }, [\n    textMeasure,\n    publishedTopics,\n    subscribedTopics,\n    services,\n    topicVisibility,\n    topicPassesConditions,\n    showServices,\n  ]);\n\n  const graph = useRef<GraphMutation>();\n\n  const onZoomFit = useCallback(() => {\n    graph.current?.fit();\n  }, []);\n\n  const toggleOrientation = useCallback(() => {\n    graph.current?.resetUserPanZoom();\n    setLROrientation(!lrOrientation);\n  }, [lrOrientation]);\n\n  const topicVisibilityTooltip: string = useMemo(() => {\n    return `Showing ${topicVisibilityToLabelMap[topicVisibility].toLowerCase()}`;\n  }, [topicVisibility]);\n\n  const toggleShowServices = useCallback(() => {\n    graph.current?.resetUserPanZoom();\n    setShowServices(!showServices);\n  }, [showServices]);\n\n  if (publishedTopics == undefined) {\n    return (\n      <>\n        <PanelToolbar />\n        <EmptyState>Waiting for data...</EmptyState>\n      </>\n    );\n  }\n\n  return (\n    <>\n      <PanelToolbar />\n      <div className={classes.root}>\n        <Paper square={false} elevation={4} className={classes.pointerEventsAuto}>\n          <Stack flex=\"0 0\" className={cx(classes.stack, classes.pointerEventsAuto)}>\n            <IconButton title=\"Zoom fit\" onClick={onZoomFit} className={classes.icon}>\n              <PageFit16Regular />\n            </IconButton>\n            <IconButton title=\"Orientation\" onClick={toggleOrientation} className={classes.icon}>\n              <ArrowBidirectionalUpDown16Regular\n                style={{ transform: `rotate(${lrOrientation ? 90 : 0}deg)` }}\n              />\n            </IconButton>\n            <IconButton\n              color={showServices ? \"info\" : \"inherit\"}\n              className={classes.icon}\n              title={showServices ? \"Showing services\" : \"Hiding services\"}\n              onClick={toggleShowServices}\n            >\n              <RectangleLandscape16Regular />\n            </IconButton>\n          </Stack>\n        </Paper>\n\n        <ExpandingToolbar\n          checked={topicVisibility !== \"none\"}\n          dataTest=\"set-topic-visibility\"\n          tooltip={topicVisibilityTooltip}\n          icon={<Diamond32Filled />}\n          selectedTab={selectedTab}\n          onSelectTab={(newSelectedTab) => {\n            setSelectedTab(newSelectedTab);\n          }}\n        >\n          <ToolGroup name=\"Topics\">\n            <div className={classes.toolbarContent}>\n              <RadioGroup\n                defaultValue={topicVisibility}\n                onChange={(_event, value) => {\n                  graph.current?.resetUserPanZoom();\n                  setTopicVisibility(value as TopicVisibility);\n                }}\n              >\n                {Object.entries(topicVisibilityToLabelMap).map(([id, label]) => (\n                  <FormControlLabel key={id} value={id} control={<Radio />} label={label} />\n                ))}\n              </RadioGroup>\n            </div>\n          </ToolGroup>\n        </ExpandingToolbar>\n      </div>\n      <Graph\n        style={STYLESHEET}\n        elements={elements}\n        rankDir={lrOrientation ? \"LR\" : \"TB\"}\n        graphRef={graph}\n      />\n    </>\n  );\n}\n\nTopicGraph.panelType = \"TopicGraph\";\nTopicGraph.defaultConfig = {};\n\nexport default Panel(TopicGraph);\n"],"names":["PANE_HEIGHT","useStyles","theme","ToolGroup","children","ToolGroupFixedSizePane","ExpandingToolbar","checked","icon","onSelectTab","selectedTab","tooltip","dataTest","classes","selectedTabLocal","React","child","selectedChild","handleChange","_event","value","DAG_LAYOUT","Graph","props","cy","graphRef","userPanZoom","elements","rankDir","LABEL_MAX_WIDTH","STYLESHEET","topicVisibilityToLabelMap","unionInto","dest","iterables","iterable","item","TopicGraph","cx","setSelectedTab","publishedTopics","ctx","subscribedTopics","services","lrOrientation","setLROrientation","showServices","setShowServices","topicVisibility","setTopicVisibility","textMeasure","topicPassesConditions","topicIdWithSubscriptions","topic","published","subscribed","output","nodeIds","topicIds","serviceIds","curNodes","node","widthPx","service","publishers","pubNode","subNode","source","target","subscribers","providers","graph","onZoomFit","toggleOrientation","topicVisibilityTooltip","toggleShowServices","PanelToolbar","EmptyState","Paper","Stack","IconButton","newSelectedTab","RadioGroup","id","label","FormControlLabel","Radio","Panel"],"sourceRoot":""}