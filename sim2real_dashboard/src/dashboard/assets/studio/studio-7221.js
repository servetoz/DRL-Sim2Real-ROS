"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7221],{89600:(V,C,t)=>{var n,Z=t(71600);n={value:!0},C.Z=void 0;var A=Z(t(68671)),i=t(52322),S=(0,A.default)([(0,i.jsx)("path",{d:"M18 6.41 16.59 5 12 9.58 7.41 5 6 6.41l6 6z"},"0"),(0,i.jsx)("path",{d:"m18 13-1.41-1.41L12 16.17l-4.59-4.58L6 13l6 6z"},"1")],"KeyboardDoubleArrowDown");C.Z=S},87221:(V,C,t)=>{t.r(C),t.d(C,{default:()=>$e});var n=t(52322),Z=t(67067),A=t(76635),i=t(2784),S=t(68588),z=t(59506),K=t(14075),J=t(76479),b=t(93812),Y=t(39367),Q=t(98967),X=t(80078),k=t(68434),w=t(29800),F=t(8740),q=t(49318),_=t(68234),ee=t(34425);const se=(0,F.ZL)()(e=>({input:{".MuiInputBase-root.MuiInputBase-sizeSmall .MuiAutocomplete-input.MuiInputBase-inputSizeSmall":{paddingBottom:e.spacing(.425),paddingTop:e.spacing(.425)},".MuiInputBase-root.MuiInputBase-sizeSmall":{padding:e.spacing(.125),gap:e.spacing(.25)}},chip:{"&.MuiAutocomplete-tag":{margin:0}}}));function te({items:e,suggestions:s,onChange:o}){const{classes:a}=se();return(0,n.jsx)(ee.Z,{value:e,multiple:!0,onChange:(r,m)=>o(m),id:"tags-filled",options:s,freeSolo:!0,fullWidth:!0,ChipProps:{className:a.chip,variant:"filled",size:"small"},renderInput:r=>(0,n.jsx)(_.Z,{...r,size:"small",className:a.input,placeholder:"Search filter"})})}const O=(0,F.ZL)()(({palette:e})=>({fatal:{color:e.error.main,fontWeight:"bold"},error:{color:e.error.main},warn:{color:e.warning.main},info:{color:e.info.main},debug:{color:e.text.secondary}}));var oe=t(28e3),u;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.FATAL=5]="FATAL"})(u||(u={}));function E(e){switch(e){case u.DEBUG:return"DEBUG";case u.INFO:return"INFO";case u.WARN:return"WARN";case u.ERROR:return"ERROR";case u.FATAL:return"FATAL";default:return"?????"}}const M=[{text:">= DEBUG",key:u.DEBUG},{text:">= INFO",key:u.INFO},{text:">= WARN",key:u.WARN},{text:">= ERROR",key:u.ERROR},{text:">= FATAL",key:u.FATAL}],ne=(0,F.ZL)()(e=>({root:{marginRight:e.spacing(-1)},levelSelect:{".MuiSelect-select.MuiInputBase-inputSizeSmall":{paddingBottom:`${e.spacing(.375)} !important`,paddingTop:`${e.spacing(.375)} !important`}}}));function ae(e){const{classes:s}=O(),{classes:o,cx:a}=ne(),r=(0,i.useCallback)(l=>{const d=E(l);return a({[s.fatal]:d==="FATAL",[s.error]:d==="ERROR",[s.warn]:d==="WARN",[s.info]:d==="INFO",[s.debug]:d==="DEBUG"})},[a,s.debug,s.error,s.fatal,s.info,s.warn]),m=M.map((l,d)=>{const g=r(l.key);return(0,n.jsx)(X.Z,{value:l.key,className:g,children:(0,n.jsx)(k.Z,{variant:"body2",children:l.text})},d)}),c=(0,i.useCallback)(l=>{const d=M.find(x=>x.key===l),g=r(Number(d?.key??u.DEBUG));return(0,n.jsx)("div",{className:g,children:d?.text})},[r]);return(0,n.jsxs)(b.Z,{className:o.root,flex:"auto",direction:"row",gap:.5,alignItems:"center",children:[(0,n.jsx)(w.Z,{className:o.levelSelect,value:e.minLogLevel,size:"small",renderValue:c,onChange:l=>{e.onFilterChange({minLogLevel:Number(l.target.value),searchTerms:Array.from(e.searchTerms)})},children:m}),(0,n.jsx)(te,{items:[...e.searchTerms],suggestions:[...e.nodeNames],onChange:l=>{e.onFilterChange({minLogLevel:e.minLogLevel,searchTerms:l})}}),(0,n.jsx)(b.Z,{direction:"row",alignItems:"center",gap:.5,children:(0,n.jsx)(q.Z,{onClick:()=>{oe.Z.copy(JSON.stringify(e.messages,void 0,2)??"")},title:"Copy log to clipboard",children:(0,n.jsx)(Q.Z,{})})})]})}var re=t(89600),le=t(31461),T=t(7896),B=t(6277),ie=t(49863),ce=t(47021),j=t(7342),de=t(43853),ue=t(20411),me=t(51538);function ge(e){return(0,me.Z)("MuiFab",e)}const W=(0,ue.Z)("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]);var U=t(65992);const fe=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],ve=e=>{const{color:s,variant:o,classes:a,size:r}=e,m={root:["root",o,`size${(0,j.Z)(r)}`,s==="inherit"?"colorInherit":s]},c=(0,ie.Z)(m,ge,a);return(0,T.Z)({},a,c)},he=(0,U.ZP)(ce.Z,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>(0,U.FO)(e)||e==="classes",overridesResolver:(e,s)=>{const{ownerState:o}=e;return[s.root,s[o.variant],s[`size${(0,j.Z)(o.size)}`],o.color==="inherit"&&s.colorInherit,s[(0,j.Z)(o.size)],s[o.color]]}})(({theme:e,ownerState:s})=>{var o,a;return(0,T.Z)({},e.typography.button,{minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:(o=(a=e.palette).getContrastText)==null?void 0:o.call(a,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${W.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]}},s.size==="small"&&{width:40,height:40},s.size==="medium"&&{width:48,height:48},s.variant==="extended"&&{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},s.variant==="extended"&&s.size==="small"&&{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34},s.variant==="extended"&&s.size==="medium"&&{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40},s.color==="inherit"&&{color:"inherit"})},({theme:e,ownerState:s})=>(0,T.Z)({},s.color!=="inherit"&&s.color!=="default"&&(e.vars||e).palette[s.color]!=null&&{color:(e.vars||e).palette[s.color].contrastText,backgroundColor:(e.vars||e).palette[s.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[s.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[s.color].main}}}),({theme:e})=>({[`&.${W.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}})),xe=i.forwardRef(function(s,o){const a=(0,de.Z)({props:s,name:"MuiFab"}),{children:r,className:m,color:c="default",component:l="button",disabled:d=!1,disableFocusRipple:g=!1,focusVisibleClassName:x,size:h="large",variant:L="circular"}=a,R=(0,le.Z)(a,fe),N=(0,T.Z)({},a,{color:c,component:l,disabled:d,disableFocusRipple:g,size:h,variant:L}),f=ve(N);return(0,n.jsx)(he,(0,T.Z)({className:(0,B.Z)(f.root,m),component:l,disabled:d,focusRipple:!g,focusVisibleClassName:(0,B.Z)(f.focusVisible,x),ownerState:N,ref:o},R,{classes:f,children:r}))});var pe=t(62515),Le=t(16003),Re=t(23509),Ne=t(8301),Ce=t(74602),Ae=t(77075),Fe=t(85091);function D(e,s){return(0,A.padStart)(`${e}`,s,"0")}function Te(e){if(e.timestampFormat==="TOD"){const s=(0,Fe.mr)(e.stamp,e.timeZone);return(0,n.jsx)("span",{children:s})}else return(0,n.jsxs)("span",{children:[D(e.stamp.sec,10),".",D(e.stamp.nsec,9)]})}const be=Te;var ye=t(2784);const Ze=(0,F.ZL)()({root:{textIndent:-20,paddingLeft:20,whiteSpace:"pre-wrap",paddingTop:1,paddingBottom:1,lineHeight:1,fontFamily:Ae.R.MONOSPACE}}),Se=ye.memo(function(s){const{value:o,timestampFormat:a,timeZone:r}=s,{classes:m,cx:c}=Ze(),{classes:l}=O(),d=`${o.file}:${o.line}`,g=E(o.level),x=o.stamp,h=o.message.split(`
`);return(0,n.jsxs)("div",{title:d,className:c(m.root,{[l.fatal]:g==="FATAL",[l.error]:g==="ERROR",[l.warn]:g==="WARN",[l.info]:g==="INFO",[l.debug]:g==="DEBUG"}),children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{children:["[",(0,A.padStart)(g,5," "),"]"]}),(0,n.jsxs)("span",{children:["[",(0,n.jsx)(be,{stamp:x,timestampFormat:a,timeZone:r}),"]"]}),o.name!=null&&(0,n.jsxs)("span",{children:["[",o.name,"]:"]}),(0,n.jsx)("span",{children:"\xA0"}),(0,n.jsx)("span",{children:h[0]})]}),(0,n.jsx)("div",{children:h.slice(1).map((L,R)=>(0,n.jsxs)("div",{children:["\xA0\xA0\xA0\xA0",L]},R))})]})});var P=t(2784);const je=(0,F.ZL)()(e=>({floatingButton:{position:"absolute",bottom:0,right:0,margin:e.spacing(1.5)}}));function Ie(e){const{timeFormat:s,timeZone:o}=(0,Ce.v)(),a=(0,i.useRef)(null);(0,i.useEffect)(()=>{a.current&&e.data.setRowHeight(e.index,a.current.clientHeight)},[e.data,e.index]);const r=e.data.items[e.index];return(0,n.jsx)("div",{style:{...e.style,height:"auto"},ref:a,children:(0,n.jsx)(Se,{value:r,timestampFormat:s,timeZone:o})})}function ze({items:e}){const{classes:s}=je(),o=(0,i.useRef)(null),a=(0,i.useRef)(null),r=(0,Le.Z)(e),[m,c]=(0,i.useState)(!0),l=P.useCallback(()=>{c(!0),o.current?.scrollToItem(r.current.length-1,"end")},[r]);(0,i.useEffect)(()=>{m&&o.current?.scrollToItem(e.length-1,"end")},[m,e.length]);const d=P.useCallback(({scrollDirection:f,scrollOffset:p,scrollUpdateWasRequested:I})=>{const v=p+(a.current?.offsetHeight??0)===a.current?.scrollHeight;!I&&f==="backward"&&!v?c(!1):f==="forward"&&v&&c(!0)},[]),g=(0,i.useRef)({}),x=(0,i.useCallback)(f=>g.current[f]??16,[]),h=(0,i.useCallback)((f,p)=>{g.current[f]=p,o.current?.resetAfterIndex(f)},[]),{width:L,ref:R}=(0,pe.NB)({refreshRate:0,refreshMode:"debounce"}),N=(0,i.useMemo)(()=>({items:e,setRowHeight:h}),[e,h,L]);return(0,n.jsx)(Re.qj,{children:({width:f,height:p})=>(0,n.jsxs)("div",{style:{position:"relative",width:f,height:p},ref:R,children:[(0,n.jsx)(Ne.S_,{ref:o,width:f,height:p,style:{outline:"none"},itemData:N,itemSize:x,itemCount:e.length,outerRef:a,onScroll:d,children:Ie}),!m&&(0,n.jsx)(xe,{size:"small",title:"Scroll to bottom",onClick:l,className:s.floatingButton,children:(0,n.jsx)(re.Z,{})})]})})}const Oe=ze;var Ee=t(44668);function G(e){return"msg"in e?e.msg:"message"in e?e.message:""}function $(e,s){switch(e){case"foxglove_msgs/Log":case"foxglove_msgs/msg/Log":case"foxglove.Log":return s.level;case"rosgraph_msgs/Log":case"rcl_interfaces/msg/Log":return We(s.level)}return u.UNKNOWN}function Me(e,s){switch(e){case"foxglove_msgs/Log":case"foxglove_msgs/msg/Log":case"foxglove.Log":{const o=s.timestamp;return typeof o=="bigint"?(0,Ee.fromNanoSec)(o):o}case"rosgraph_msgs/Log":return s.header.stamp;case"rcl_interfaces/msg/Log":return s.stamp}return{sec:0,nsec:0}}function Be(e,s){const o=G(s),a=Me(e,s),r=$(e,s);return{message:o,stamp:a,level:r,name:s.name,file:s.file,line:s.line}}function We(e){switch(e){case 1:case 10:return u.DEBUG;case 2:case 20:return u.INFO;case 4:case 30:return u.WARN;case 8:case 40:return u.ERROR;case 16:case 50:return u.FATAL;default:return u.UNKNOWN}}function Ue(e,s){const{minLogLevel:o,searchTerms:a}=s;if(!(o>1||a.length>0))return e;const m=a.map(c=>c.toLowerCase());return e.filter(c=>{const l=c.message;if($(c.schemaName,l)<o)return!1;if(a.length===0)return!0;const g=l.name?.toLowerCase()??"",x=G(l).toLowerCase();return m.some(h=>g.includes(h)||x.includes(h))})}function De(e,s,o){const a=s.map(c=>({label:c.name,value:c.name})),r=s.some(c=>c.name===e);r||a.unshift({value:e,label:e});const m=r?void 0:o("topicError",{topic:e});return{general:{fields:{topicToRender:{input:"select",label:o("topic"),value:e,error:m,options:a}}}}}var Pe=t(2784);const Ge=["foxglove_msgs/Log","foxglove_msgs/msg/Log","foxglove.Log","rcl_interfaces/msg/Log","ros.rcl_interfaces.Log","ros.rosgraph_msgs.Log","rosgraph_msgs/Log"],H=Pe.memo(({config:e,saveConfig:s})=>{const{topics:o}=(0,z.Ui)(),{minLogLevel:a,searchTerms:r}=e,m=(0,Y.W0)(),{t:c}=(0,S.$G)("log"),l=(0,i.useCallback)(v=>{s({minLogLevel:v.minLogLevel,searchTerms:v.searchTerms})},[s]),d=(0,i.useMemo)(()=>o.filter(v=>v.schemaName!=null&&Ge.includes(v.schemaName)),[o]),g=(0,i.useMemo)(()=>d[0]?.name,[d]),x=e.topicToRender??g??"/rosout",{[x]:h=[]}=(0,z.V7)({topics:[x],historySize:1e5}),L=(0,i.useCallback)(v=>{if(v.action!=="update")return;const{path:y,value:He}=v.payload;s((0,Z.Uy)(Ve=>(0,A.set)(Ve,y.slice(1),He)))},[s]);(0,i.useEffect)(()=>{m({actionHandler:L,nodes:De(x,d,c)})},[L,d,x,m,c]);const R=(0,i.useRef)(new Set),N=(0,i.useMemo)(()=>{for(const v of h){const y=v.message.name;y!=null&&R.current.add(y)}return R.current},[h]),f=(0,i.useMemo)(()=>new Set(r),[r]),p=(0,i.useMemo)(()=>Ue(h,{minLogLevel:a,searchTerms:r}),[h,a,r]),I=(0,i.useMemo)(()=>p.map(v=>Be(v.schemaName,v.message)),[p]);return(0,n.jsxs)(b.Z,{fullHeight:!0,children:[(0,n.jsx)(J.Z,{children:(0,n.jsx)(ae,{searchTerms:f,minLogLevel:a,nodeNames:N,messages:p,onFilterChange:l})}),(0,n.jsx)(b.Z,{flexGrow:1,children:(0,n.jsx)(Oe,{items:I})})]})});H.displayName="Log";const $e=(0,K.Z)(Object.assign(H,{defaultConfig:{searchTerms:[],minLogLevel:1},panelType:"RosOut"}))}}]);

//# sourceMappingURL=studio-7221.js.map