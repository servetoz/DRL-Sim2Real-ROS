"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9596],{19596:(ae,L,s)=>{s.r(L),s.d(L,{default:()=>ue});var H=s(52322),K=s(47746),Z=s(5603),i=s(34651),G=s(91922),B=s(21023),o=s(2784);function U(e){return/^\d+$/.test(e)?"".concat(e,"px"):e}function O(){}var D=function(){return D=Object.assign||function(e){for(var t,d=1,r=arguments.length;d<r;d++){t=arguments[d];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},D.apply(this,arguments)};function z(e){var t=e.width,d=e.height,r=e.value,l=e.defaultValue,M=e.language,k=e.theme,p=e.options,N=e.overrideServices,V=e.editorWillMount,w=e.editorDidMount,j=e.editorWillUnmount,R=e.onChange,v=e.className,E=e.original,u=(0,o.useRef)(null),a=(0,o.useRef)(null),S=(0,o.useRef)(null),F=(0,o.useRef)(null),n=U(t),c=U(d),y=(0,o.useMemo)(function(){return{width:n,height:c}},[n,c]),h=function(){var f=V(i);return f||{}},m=function(){w(a.current,i);var f=a.current.getModel().modified;S.current=f.onDidChangeContent(function(P){F.current||R(f.getValue(),P)})},x=function(){j(a.current,i)},g=function(){var f=r??l,P=i.editor.createModel(E,M),W=i.editor.createModel(f,M);a.current.setModel({original:P,modified:W})};return(0,o.useEffect)(function(){u.current&&(h(),a.current=i.editor.createDiffEditor(u.current,D(D(D({},v?{extraEditorClassName:v}:{}),p),k?{theme:k}:{}),N),g(),m())},[]),(0,o.useEffect)(function(){a.current&&a.current.updateOptions(D(D({},v?{extraEditorClassName:v}:{}),p))},[v,p]),(0,o.useEffect)(function(){a.current&&a.current.layout()},[t,d]),(0,o.useEffect)(function(){if(a.current){var f=a.current.getModel(),P=f.original,W=f.modified;i.editor.setModelLanguage(P,M),i.editor.setModelLanguage(W,M)}},[M]),(0,o.useEffect)(function(){if(a.current){var f=a.current.getModel().modified;F.current=!0,a.current.getModifiedEditor().pushUndoStop(),f.pushEditOperations([],[{range:f.getFullModelRange(),text:r}]),a.current.getModifiedEditor().pushUndoStop(),F.current=!1}},[r]),(0,o.useEffect)(function(){i.editor.setTheme(k)},[k]),(0,o.useEffect)(function(){if(a.current){var f=a.current.getModel().original;E!==f.getValue()&&f.setValue(E)}},[E]),(0,o.useEffect)(function(){return function(){if(a.current){x(),a.current.dispose();var f=a.current.getModel(),P=f.original,W=f.modified;P&&P.dispose(),W&&W.dispose()}S.current&&S.current.dispose()}},[]),o.createElement("div",{ref:u,style:y,className:"react-monaco-editor-container"})}z.defaultProps={width:"100%",height:"100%",original:null,value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorWillMount:O,editorDidMount:O,editorWillUnmount:O,onChange:O,className:null},z.displayName="MonacoDiffEditor";const de=null;var b=function(){return b=Object.assign||function(e){for(var t,d=1,r=arguments.length;d<r;d++){t=arguments[d];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},b.apply(this,arguments)},J=function(e,t){var d={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(d[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(d[r[l]]=e[r[l]]);return d};function A(e){var t=e.width,d=e.height,r=e.value,l=e.defaultValue,M=e.language,k=e.theme,p=e.options,N=e.overrideServices,V=e.editorWillMount,w=e.editorDidMount,j=e.editorWillUnmount,R=e.onChange,v=e.className,E=(0,o.useRef)(null),u=(0,o.useRef)(null),a=(0,o.useRef)(null),S=(0,o.useRef)(null),F=U(t),n=U(d),c=(0,o.useMemo)(function(){return{width:F,height:n}},[F,n]),y=function(){var g=V(i);return g||{}},h=function(){w(u.current,i),a.current=u.current.onDidChangeModelContent(function(g){S.current||R(u.current.getValue(),g)})},m=function(){j(u.current,i)},x=function(){var g=r!==null?r:l;if(E.current){var f=b(b({},p),y());u.current=i.editor.create(E.current,b(b(b({value:g,language:M},v?{extraEditorClassName:v}:{}),f),k?{theme:k}:{}),N),h()}};return(0,o.useEffect)(x,[]),(0,o.useEffect)(function(){if(u.current){if(r===u.current.getValue())return;var g=u.current.getModel();S.current=!0,u.current.pushUndoStop(),g.pushEditOperations([],[{range:g.getFullModelRange(),text:r}],void 0),u.current.pushUndoStop(),S.current=!1}},[r]),(0,o.useEffect)(function(){if(u.current){var g=u.current.getModel();i.editor.setModelLanguage(g,M)}},[M]),(0,o.useEffect)(function(){if(u.current){var g=p.model,f=J(p,["model"]);u.current.updateOptions(b(b({},v?{extraEditorClassName:v}:{}),f))}},[v,p]),(0,o.useEffect)(function(){u.current&&u.current.layout()},[t,d]),(0,o.useEffect)(function(){i.editor.setTheme(k)},[k]),(0,o.useEffect)(function(){return function(){if(u.current){m(),u.current.dispose();var g=u.current.getModel();g&&g.dispose()}a.current&&a.current.dispose()}},[]),o.createElement("div",{ref:E,style:c,className:"react-monaco-editor-container"})}A.defaultProps={width:"100%",height:"100%",value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorWillMount:O,editorDidMount:O,editorWillUnmount:O,onChange:O,className:null},A.displayName="MonacoEditor";const Q=A;var X=s(62515),Y=s(16003);async function q(e){const t=await s.e(9691).then(s.t.bind(s,29691,23)),d=await s.e(4048).then(s.t.bind(s,44048,23));return t.format(e,{parser:"typescript",plugins:[d]})}const _=q;var ee=s(64942);function te(e){const t=e||typeof window<"u"&&window;return!!(t&&(t.navigator.userAgent.match(/Chromatic/)||t.location.href.match(/chromatic=true/)))}function ne(){return navigator.userAgent.includes("PuppeteerTestingChrome")||te()}var $=s(11701),oe=s(36537);const re=[{name:"vs-studio-dark",theme:{base:"vs-dark",inherit:!0,rules:[{foreground:"6c6783",token:"comment"},{foreground:"eba800",token:"string"},{foreground:"9987ff",token:"constant.numeric"},{foreground:"9987ff",token:"constant.language"},{foreground:"9987ff",token:"constant.character"},{foreground:"9987ff",token:"constant.other"},{foreground:"e05ffa",token:"keyword"},{foreground:"e05ffa",token:"storage"},{foreground:"45a5ff",fontStyle:"italic",token:"storage.type"},{foreground:"6bd66f",fontStyle:"underline",token:"entity.name.class"},{foreground:"6bd66f",fontStyle:"italic underline",token:"entity.other.inherited-class"},{foreground:"6bd66f",token:"entity.name.function"},{foreground:"fc8942",fontStyle:"italic",token:"variable.parameter"},{foreground:"db3553",token:"entity.name.tag"},{foreground:"6bd66f",token:"entity.other.attribute-name"},{foreground:"45a5ff",token:"support.function"},{foreground:"45a5ff",token:"support.constant"},{foreground:"45a5ff",fontStyle:"italic",token:"support.type"},{foreground:"45a5ff",fontStyle:"italic",token:"support.class"},{foreground:"f0f0f0",background:"ff6b82",token:"invalid"},{foreground:"f0f0f0",background:"6858f5",token:"invalid.deprecated"}],colors:{"editor.foreground":"#F7F7F3C4","editor.background":"#08080A","editor.selectionBackground":"#F7F7F326","editor.lineHighlightBackground":"#F7F7F31A","editorCursor.foreground":"#F7F7F3C4","editorWhitespace.foreground":"#3B3A32"}}},{name:"vs-studio-light",theme:{base:"vs",inherit:!0,rules:[{foreground:"eefff8",background:"2f8963",token:"markup.inserted.diff"},{foreground:"eefff8",background:"2f8963",token:"meta.diff.header.to-file"},{foreground:"fff3ee",background:"c86a44",token:"markup.deleted.diff"},{foreground:"fff3ee",background:"c86a44",token:"meta.diff.header.from-file"},{foreground:"008000",token:"comment"},{foreground:"000000",token:"variable"},{foreground:"0000ff",token:"keyword"},{foreground:"a31515",token:"constant.numeric"},{foreground:"000000",token:"constant"},{foreground:"000000",token:"constant.language"},{foreground:"0000ff",token:"constant.language.boolean"},{foreground:"a31515",token:"string"},{foreground:"26b31a",token:"constant.character.escape"},{foreground:"26b31a",token:"string source"},{foreground:"0000ff",token:"meta.preprocessor"},{foreground:"0000ff",token:"keyword.control.import"},{foreground:"000000",token:"entity.name.function"},{foreground:"000000",token:"keyword.other.name-of-parameter.objc"},{foreground:"000000",token:"entity.name.type"},{foreground:"0000ff",token:"storage.type"},{foreground:"0000ff",token:"storage.modifier"},{foreground:"70727e",token:"storage.type.method"},{foreground:"000000",token:"support.function"},{foreground:"000000",token:"support.class"},{foreground:"000000",token:"support.type"},{foreground:"000000",token:"support.constant"},{foreground:"000000",token:"support.variable"},{foreground:"687687",token:"keyword.operator.js"},{background:"e1a09f",token:"invalid"},{background:"ffd0d0",token:"invalid.deprecated.trailing-whitespace"},{background:"427ff530",token:"text source"},{background:"427ff530",token:"string.unquoted"},{foreground:"68685b",token:"meta.xml-processing"},{foreground:"68685b",token:"declaration.xml-processing"},{foreground:"a31515",token:"meta.doctype"},{foreground:"a31515",token:"declaration.doctype"},{foreground:"0000ff",token:"meta.tag"},{foreground:"0000ff",token:"declaration.tag"},{foreground:"a31515",token:"entity.name.tag"},{foreground:"ff0000",token:"entity.other.attribute-name"},{foreground:"0000ff",token:"string.quoted.double.xml"},{foreground:"0000ff",token:"string.quoted.double.html"},{foreground:"0c07ff",token:"markup.heading"},{foreground:"000000",token:"markup.quote"},{foreground:"b90690",token:"markup.list"}],colors:{"editor.foreground":"#000000","editor.background":"#FFFFFF","editor.selectionBackground":"#9DA7C3","editor.lineHighlightBackground":"#00000012","editorCursor.foreground":"#000000","editorWhitespace.foreground":"#BFBFBF"}}}];var C=s(2784);const ie=G.IO.get(Z.$),I=(e,t)=>{if(t){const d=(0,oe.N)(t);if(d.endLineNumber!=null&&d.endColumn!=null)e.setSelection(t),e.revealRangeInCenter(t,1);else{const r={lineNumber:t.startLineNumber,column:t.startColumn};e.setPosition(r),e.revealPositionInCenter(r,1)}}},T=(0,ee.v)(),ue=({autoFormatOnSave:e,script:t,setScriptCode:d,save:r,setScriptOverride:l,rosLib:M,typesLib:k})=>{const p=C.useRef(null),N=C.useRef(e);N.current=e;const V=(0,K.Z)().palette.mode==="dark"?"vs-studio-dark":"vs-studio-light";C.useEffect(()=>{const n=i.languages.typescript.typescriptDefaults.addExtraLib(M,`file:///node_modules/@types/${T.rosLib.fileName}`);return()=>{n.dispose()}},[M]),C.useEffect(()=>{const n=i.Uri.parse(`file://${$.wd}generatedTypes.ts`),c=i.editor.getModel(n)??i.editor.createModel(k,"typescript",n);c.setValue(k),c.updateOptions({tabSize:2})},[k]),(0,o.useEffect)(()=>{const n=ie.registerCodeEditorOpenHandler(async(c,y)=>{const h=i.editor.getModel(c.resource);return h?y&&t&&h.uri.path===`${$.wd}${B.basename(t.filePath)}`?(I(y,c.options.selection),null):(l({filePath:h.uri.path,code:h.getValue(),readOnly:!0,selection:c.options?.selection}),y):y});return()=>n.dispose()},[t,l]),C.useEffect(()=>{const n=p.current;if(!n||!t)return;const c=B.basename(t.filePath),y=i.Uri.parse(`file://${$.wd}${c}`),h=i.editor.getModel(y)??i.editor.createModel(t.code,"typescript",y);h.getValue()!==t.code&&h.setValue(t.code),n.setModel(h),I(n,t.selection)},[t]);const w=C.useMemo(()=>({wordWrap:"on",minimap:{enabled:!1},readOnly:t?.readOnly}),[t]),j=C.useCallback(n=>{if(!t)return;for(const m of re)n.editor.defineTheme(m.name,m.theme);n.languages.typescript.typescriptDefaults.setEagerModelSync(!0),n.languages.typescript.javascriptDefaults.setEagerModelSync(!0),n.languages.registerDocumentFormattingEditProvider("typescript",{provideDocumentFormattingEdits:async m=>{try{return[{range:m.getFullModelRange(),text:await _(m.getValue())}]}catch{return[]}}}),ne()&&n.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0}),T.declarations.forEach(m=>n.languages.typescript.typescriptDefaults.addExtraLib(m.sourceCode,`file:///node_modules/@types/${m.fileName}`)),T.utilityFiles.forEach(m=>{const x=i.Uri.parse(`file://${m.filePath}`);(n.editor.getModel(x)??n.editor.createModel(m.sourceCode,"typescript",x)).updateOptions({tabSize:2})});const c=B.basename(t.filePath),y=i.Uri.parse(`file://${$.wd}${c}`),h=n.editor.getModel(y)??n.editor.createModel(t.code,"typescript",y);return h.updateOptions({tabSize:2}),{model:h}},[t]),R=C.useCallback(async()=>{const n=p.current?.getModel();n&&t&&!t.readOnly&&(N.current&&await p.current?.getAction("editor.action.formatDocument")?.run(),r(n.getValue()))},[r,t]),v=(0,o.useRef)(R);v.current=R;const E=C.useCallback(n=>{p.current=n,n.addAction({id:"ctrl-s",label:"Save current node",keybindings:[i.KeyMod.CtrlCmd|i.KeyCode.KeyS],run:async()=>await v.current()})},[]),u=(0,Y.Z)(d),a=(0,o.useCallback)(n=>u.current(n),[u]),S=(0,o.useCallback)((n,c)=>{n!=null&&c!=null&&p.current?.layout({width:n,height:c})},[]),{ref:F}=(0,X.NB)({refreshRate:0,refreshMode:"debounce",onResize:S});return t?(0,H.jsx)("div",{ref:F,style:{width:"100%",height:"100%"},children:(0,H.jsx)(Q,{language:"typescript",theme:V,editorWillMount:j,editorDidMount:E,options:w,onChange:a})}):null}}}]);

//# sourceMappingURL=studio-9596.js.map